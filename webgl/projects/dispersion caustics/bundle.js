!function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e,n){t.exports=function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return t[o].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){e.glMatrix=n(1),e.mat2=n(2),e.mat2d=n(3),e.mat3=n(4),e.mat4=n(5),e.quat=n(6),e.vec2=n(9),e.vec3=n(7),e.vec4=n(8)},function(t,e){var n={EPSILON:1e-6};n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.ENABLE_SIMD=!1,n.SIMD_AVAILABLE=n.ARRAY_TYPE===Float32Array&&"SIMD"in this,n.USE_SIMD=n.ENABLE_SIMD&&n.SIMD_AVAILABLE,n.setMatrixArrayType=function(t){n.ARRAY_TYPE=t};var o=Math.PI/180;n.toRadian=function(t){return t*o},t.exports=n},function(t,e,n){var o=n(1),i={create:function(){var t=new o.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},clone:function(t){var e=new o.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},transpose:function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},invert:function(t,e){var n=e[0],o=e[1],i=e[2],r=e[3],a=n*r-i*o;return a?(a=1/a,t[0]=r*a,t[1]=-o*a,t[2]=-i*a,t[3]=n*a,t):null},adjoint:function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},determinant:function(t){return t[0]*t[3]-t[2]*t[1]},multiply:function(t,e,n){var o=e[0],i=e[1],r=e[2],a=e[3],s=n[0],l=n[1],u=n[2],c=n[3];return t[0]=o*s+r*l,t[1]=i*s+a*l,t[2]=o*u+r*c,t[3]=i*u+a*c,t}};i.mul=i.multiply,i.rotate=function(t,e,n){var o=e[0],i=e[1],r=e[2],a=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=o*l+r*s,t[1]=i*l+a*s,t[2]=o*-s+r*l,t[3]=i*-s+a*l,t},i.scale=function(t,e,n){var o=e[0],i=e[1],r=e[2],a=e[3],s=n[0],l=n[1];return t[0]=o*s,t[1]=i*s,t[2]=r*l,t[3]=a*l,t},i.fromRotation=function(t,e){var n=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=n,t[2]=-n,t[3]=o,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},i.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},i.LDU=function(t,e,n,o){return t[2]=o[2]/o[0],n[0]=o[0],n[1]=o[1],n[3]=o[3]-t[2]*n[1],[t,e,n]},t.exports=i},function(t,e,n){var o=n(1),i={create:function(){var t=new o.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},clone:function(t){var e=new o.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},invert:function(t,e){var n=e[0],o=e[1],i=e[2],r=e[3],a=e[4],s=e[5],l=n*r-o*i;return l?(l=1/l,t[0]=r*l,t[1]=-o*l,t[2]=-i*l,t[3]=n*l,t[4]=(i*s-r*a)*l,t[5]=(o*a-n*s)*l,t):null},determinant:function(t){return t[0]*t[3]-t[1]*t[2]},multiply:function(t,e,n){var o=e[0],i=e[1],r=e[2],a=e[3],s=e[4],l=e[5],u=n[0],c=n[1],d=n[2],h=n[3],f=n[4],m=n[5];return t[0]=o*u+r*c,t[1]=i*u+a*c,t[2]=o*d+r*h,t[3]=i*d+a*h,t[4]=o*f+r*m+s,t[5]=i*f+a*m+l,t}};i.mul=i.multiply,i.rotate=function(t,e,n){var o=e[0],i=e[1],r=e[2],a=e[3],s=e[4],l=e[5],u=Math.sin(n),c=Math.cos(n);return t[0]=o*c+r*u,t[1]=i*c+a*u,t[2]=o*-u+r*c,t[3]=i*-u+a*c,t[4]=s,t[5]=l,t},i.scale=function(t,e,n){var o=e[0],i=e[1],r=e[2],a=e[3],s=e[4],l=e[5],u=n[0],c=n[1];return t[0]=o*u,t[1]=i*u,t[2]=r*c,t[3]=a*c,t[4]=s,t[5]=l,t},i.translate=function(t,e,n){var o=e[0],i=e[1],r=e[2],a=e[3],s=e[4],l=e[5],u=n[0],c=n[1];return t[0]=o,t[1]=i,t[2]=r,t[3]=a,t[4]=o*u+r*c+s,t[5]=i*u+a*c+l,t},i.fromRotation=function(t,e){var n=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=n,t[2]=-n,t[3]=o,t[4]=0,t[5]=0,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},i.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},t.exports=i},function(t,e,n){var o=n(1),i={create:function(){var t=new o.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromMat4:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},clone:function(t){var e=new o.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},transpose:function(t,e){if(t===e){var n=e[1],o=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=o,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},invert:function(t,e){var n=e[0],o=e[1],i=e[2],r=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],d=c*a-s*u,h=-c*r+s*l,f=u*r-a*l,m=n*d+o*h+i*f;return m?(m=1/m,t[0]=d*m,t[1]=(-c*o+i*u)*m,t[2]=(s*o-i*a)*m,t[3]=h*m,t[4]=(c*n-i*l)*m,t[5]=(-s*n+i*r)*m,t[6]=f*m,t[7]=(-u*n+o*l)*m,t[8]=(a*n-o*r)*m,t):null},adjoint:function(t,e){var n=e[0],o=e[1],i=e[2],r=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8];return t[0]=a*c-s*u,t[1]=i*u-o*c,t[2]=o*s-i*a,t[3]=s*l-r*c,t[4]=n*c-i*l,t[5]=i*r-n*s,t[6]=r*u-a*l,t[7]=o*l-n*u,t[8]=n*a-o*r,t},determinant:function(t){var e=t[0],n=t[1],o=t[2],i=t[3],r=t[4],a=t[5],s=t[6],l=t[7],u=t[8];return e*(u*r-a*l)+n*(-u*i+a*s)+o*(l*i-r*s)},multiply:function(t,e,n){var o=e[0],i=e[1],r=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],d=e[8],h=n[0],f=n[1],m=n[2],p=n[3],_=n[4],x=n[5],v=n[6],g=n[7],b=n[8];return t[0]=h*o+f*a+m*u,t[1]=h*i+f*s+m*c,t[2]=h*r+f*l+m*d,t[3]=p*o+_*a+x*u,t[4]=p*i+_*s+x*c,t[5]=p*r+_*l+x*d,t[6]=v*o+g*a+b*u,t[7]=v*i+g*s+b*c,t[8]=v*r+g*l+b*d,t}};i.mul=i.multiply,i.translate=function(t,e,n){var o=e[0],i=e[1],r=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],d=e[8],h=n[0],f=n[1];return t[0]=o,t[1]=i,t[2]=r,t[3]=a,t[4]=s,t[5]=l,t[6]=h*o+f*a+u,t[7]=h*i+f*s+c,t[8]=h*r+f*l+d,t},i.rotate=function(t,e,n){var o=e[0],i=e[1],r=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],d=e[8],h=Math.sin(n),f=Math.cos(n);return t[0]=f*o+h*a,t[1]=f*i+h*s,t[2]=f*r+h*l,t[3]=f*a-h*o,t[4]=f*s-h*i,t[5]=f*l-h*r,t[6]=u,t[7]=c,t[8]=d,t},i.scale=function(t,e,n){var o=n[0],i=n[1];return t[0]=o*e[0],t[1]=o*e[1],t[2]=o*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},i.fromRotation=function(t,e){var n=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=n,t[2]=0,t[3]=-n,t[4]=o,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},i.fromQuat=function(t,e){var n=e[0],o=e[1],i=e[2],r=e[3],a=n+n,s=o+o,l=i+i,u=n*a,c=o*a,d=o*s,h=i*a,f=i*s,m=i*l,p=r*a,_=r*s,x=r*l;return t[0]=1-d-m,t[3]=c-x,t[6]=h+_,t[1]=c+x,t[4]=1-u-m,t[7]=f-p,t[2]=h-_,t[5]=f+p,t[8]=1-u-d,t},i.normalFromMat4=function(t,e){var n=e[0],o=e[1],i=e[2],r=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],d=e[9],h=e[10],f=e[11],m=e[12],p=e[13],_=e[14],x=e[15],v=n*s-o*a,g=n*l-i*a,b=n*u-r*a,M=o*l-i*s,y=o*u-r*s,S=i*u-r*l,w=c*p-d*m,D=c*_-h*m,I=c*x-f*m,E=d*_-h*p,A=d*x-f*p,F=h*x-f*_,z=v*F-g*A+b*E+M*I-y*D+S*w;return z?(z=1/z,t[0]=(s*F-l*A+u*E)*z,t[1]=(l*I-a*F-u*D)*z,t[2]=(a*A-s*I+u*w)*z,t[3]=(i*A-o*F-r*E)*z,t[4]=(n*F-i*I+r*D)*z,t[5]=(o*I-n*A-r*w)*z,t[6]=(p*S-_*y+x*M)*z,t[7]=(_*b-m*S-x*g)*z,t[8]=(m*y-p*b+x*v)*z,t):null},i.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},t.exports=i},function(t,e,n){var o=n(1),i={scalar:{},SIMD:{},create:function(){var t=new o.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},clone:function(t){var e=new o.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}};i.scalar.transpose=function(t,e){if(t===e){var n=e[1],o=e[2],i=e[3],r=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=o,t[9]=r,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},i.SIMD.transpose=function(t,e){var n,o,i,r,a,s,l,u,c,d;return n=SIMD.Float32x4.load(e,0),o=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),r=SIMD.Float32x4.load(e,12),a=SIMD.Float32x4.shuffle(n,o,0,1,4,5),s=SIMD.Float32x4.shuffle(i,r,0,1,4,5),l=SIMD.Float32x4.shuffle(a,s,0,2,4,6),u=SIMD.Float32x4.shuffle(a,s,1,3,5,7),SIMD.Float32x4.store(t,0,l),SIMD.Float32x4.store(t,4,u),a=SIMD.Float32x4.shuffle(n,o,2,3,6,7),s=SIMD.Float32x4.shuffle(i,r,2,3,6,7),c=SIMD.Float32x4.shuffle(a,s,0,2,4,6),d=SIMD.Float32x4.shuffle(a,s,1,3,5,7),SIMD.Float32x4.store(t,8,c),SIMD.Float32x4.store(t,12,d),t},i.transpose=o.USE_SIMD?i.SIMD.transpose:i.scalar.transpose,i.scalar.invert=function(t,e){var n=e[0],o=e[1],i=e[2],r=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],d=e[9],h=e[10],f=e[11],m=e[12],p=e[13],_=e[14],x=e[15],v=n*s-o*a,g=n*l-i*a,b=n*u-r*a,M=o*l-i*s,y=o*u-r*s,S=i*u-r*l,w=c*p-d*m,D=c*_-h*m,I=c*x-f*m,E=d*_-h*p,A=d*x-f*p,F=h*x-f*_,z=v*F-g*A+b*E+M*I-y*D+S*w;return z?(z=1/z,t[0]=(s*F-l*A+u*E)*z,t[1]=(i*A-o*F-r*E)*z,t[2]=(p*S-_*y+x*M)*z,t[3]=(h*y-d*S-f*M)*z,t[4]=(l*I-a*F-u*D)*z,t[5]=(n*F-i*I+r*D)*z,t[6]=(_*b-m*S-x*g)*z,t[7]=(c*S-h*b+f*g)*z,t[8]=(a*A-s*I+u*w)*z,t[9]=(o*I-n*A-r*w)*z,t[10]=(m*y-p*b+x*v)*z,t[11]=(d*b-c*y-f*v)*z,t[12]=(s*D-a*E-l*w)*z,t[13]=(n*E-o*D+i*w)*z,t[14]=(p*g-m*M-_*v)*z,t[15]=(c*M-d*g+h*v)*z,t):null},i.SIMD.invert=function(t,e){var n,o,i,r,a,s,l,u,c,d,h=SIMD.Float32x4.load(e,0),f=SIMD.Float32x4.load(e,4),m=SIMD.Float32x4.load(e,8),p=SIMD.Float32x4.load(e,12);return a=SIMD.Float32x4.shuffle(h,f,0,1,4,5),o=SIMD.Float32x4.shuffle(m,p,0,1,4,5),n=SIMD.Float32x4.shuffle(a,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,a,1,3,5,7),a=SIMD.Float32x4.shuffle(h,f,2,3,6,7),r=SIMD.Float32x4.shuffle(m,p,2,3,6,7),i=SIMD.Float32x4.shuffle(a,r,0,2,4,6),r=SIMD.Float32x4.shuffle(r,a,1,3,5,7),a=SIMD.Float32x4.mul(i,r),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.mul(o,a),l=SIMD.Float32x4.mul(n,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),s),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),a=SIMD.Float32x4.mul(o,i),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),s),c=SIMD.Float32x4.mul(n,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(r,a)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),a=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(o,2,3,0,1),r),a=SIMD.Float32x4.swizzle(a,1,0,3,2),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),s),u=SIMD.Float32x4.mul(n,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(i,a)),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),a=SIMD.Float32x4.mul(n,o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),u),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),c),a=SIMD.Float32x4.swizzle(a,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,a),u),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(i,a)),a=SIMD.Float32x4.mul(n,r),a=SIMD.Float32x4.swizzle(a,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(i,a)),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),u),a=SIMD.Float32x4.swizzle(a,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),l),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,a)),a=SIMD.Float32x4.mul(n,i),a=SIMD.Float32x4.swizzle(a,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),l),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(o,a)),a=SIMD.Float32x4.swizzle(a,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(r,a)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),c),d=SIMD.Float32x4.mul(n,s),d=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(d,2,3,0,1),d),d=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(d,1,0,3,2),d),a=SIMD.Float32x4.reciprocalApproximation(d),d=SIMD.Float32x4.sub(SIMD.Float32x4.add(a,a),SIMD.Float32x4.mul(d,SIMD.Float32x4.mul(a,a))),(d=SIMD.Float32x4.swizzle(d,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(d,s)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(d,l)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(d,u)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(d,c)),t):null},i.invert=o.USE_SIMD?i.SIMD.invert:i.scalar.invert,i.scalar.adjoint=function(t,e){var n=e[0],o=e[1],i=e[2],r=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],d=e[9],h=e[10],f=e[11],m=e[12],p=e[13],_=e[14],x=e[15];return t[0]=s*(h*x-f*_)-d*(l*x-u*_)+p*(l*f-u*h),t[1]=-(o*(h*x-f*_)-d*(i*x-r*_)+p*(i*f-r*h)),t[2]=o*(l*x-u*_)-s*(i*x-r*_)+p*(i*u-r*l),t[3]=-(o*(l*f-u*h)-s*(i*f-r*h)+d*(i*u-r*l)),t[4]=-(a*(h*x-f*_)-c*(l*x-u*_)+m*(l*f-u*h)),t[5]=n*(h*x-f*_)-c*(i*x-r*_)+m*(i*f-r*h),t[6]=-(n*(l*x-u*_)-a*(i*x-r*_)+m*(i*u-r*l)),t[7]=n*(l*f-u*h)-a*(i*f-r*h)+c*(i*u-r*l),t[8]=a*(d*x-f*p)-c*(s*x-u*p)+m*(s*f-u*d),t[9]=-(n*(d*x-f*p)-c*(o*x-r*p)+m*(o*f-r*d)),t[10]=n*(s*x-u*p)-a*(o*x-r*p)+m*(o*u-r*s),t[11]=-(n*(s*f-u*d)-a*(o*f-r*d)+c*(o*u-r*s)),t[12]=-(a*(d*_-h*p)-c*(s*_-l*p)+m*(s*h-l*d)),t[13]=n*(d*_-h*p)-c*(o*_-i*p)+m*(o*h-i*d),t[14]=-(n*(s*_-l*p)-a*(o*_-i*p)+m*(o*l-i*s)),t[15]=n*(s*h-l*d)-a*(o*h-i*d)+c*(o*l-i*s),t},i.SIMD.adjoint=function(t,e){var n,o,i,r,a,s,l,u,c,d=SIMD.Float32x4.load(e,0),h=SIMD.Float32x4.load(e,4),f=SIMD.Float32x4.load(e,8),m=SIMD.Float32x4.load(e,12);return a=SIMD.Float32x4.shuffle(d,h,0,1,4,5),o=SIMD.Float32x4.shuffle(f,m,0,1,4,5),n=SIMD.Float32x4.shuffle(a,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,a,1,3,5,7),a=SIMD.Float32x4.shuffle(d,h,2,3,6,7),r=SIMD.Float32x4.shuffle(f,m,2,3,6,7),i=SIMD.Float32x4.shuffle(a,r,0,2,4,6),r=SIMD.Float32x4.shuffle(r,a,1,3,5,7),a=SIMD.Float32x4.mul(i,r),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.mul(o,a),l=SIMD.Float32x4.mul(n,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),s),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),a=SIMD.Float32x4.mul(o,i),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),s),c=SIMD.Float32x4.mul(n,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(r,a)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),a=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(o,2,3,0,1),r),a=SIMD.Float32x4.swizzle(a,1,0,3,2),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),s),u=SIMD.Float32x4.mul(n,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(i,a)),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),a=SIMD.Float32x4.mul(n,o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),u),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),c),a=SIMD.Float32x4.swizzle(a,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,a),u),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(i,a)),a=SIMD.Float32x4.mul(n,r),a=SIMD.Float32x4.swizzle(a,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(i,a)),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),u),a=SIMD.Float32x4.swizzle(a,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),l),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,a)),a=SIMD.Float32x4.mul(n,i),a=SIMD.Float32x4.swizzle(a,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),l),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(o,a)),a=SIMD.Float32x4.swizzle(a,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(r,a)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),c),SIMD.Float32x4.store(t,0,s),SIMD.Float32x4.store(t,4,l),SIMD.Float32x4.store(t,8,u),SIMD.Float32x4.store(t,12,c),t},i.adjoint=o.USE_SIMD?i.SIMD.adjoint:i.scalar.adjoint,i.determinant=function(t){var e=t[0],n=t[1],o=t[2],i=t[3],r=t[4],a=t[5],s=t[6],l=t[7],u=t[8],c=t[9],d=t[10],h=t[11],f=t[12],m=t[13],p=t[14],_=t[15],x=e*a-n*r,v=e*s-o*r,g=e*l-i*r,b=n*s-o*a,M=n*l-i*a,y=o*l-i*s,S=u*m-c*f,w=u*p-d*f,D=u*_-h*f,I=c*p-d*m,E=c*_-h*m,A=d*_-h*p;return x*A-v*E+g*I+b*D-M*w+y*S},i.SIMD.multiply=function(t,e,n){var o=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4),r=SIMD.Float32x4.load(e,8),a=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4.load(n,0),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),o),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),r),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),a))));SIMD.Float32x4.store(t,0,l);var u=SIMD.Float32x4.load(n,4),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,0,0,0,0),o),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,2,2,2),r),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,3,3,3,3),a))));SIMD.Float32x4.store(t,4,c);var d=SIMD.Float32x4.load(n,8),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,0,0,0,0),o),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,2,2,2),r),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,3,3,3,3),a))));SIMD.Float32x4.store(t,8,h);var f=SIMD.Float32x4.load(n,12),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),o),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),r),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),a))));return SIMD.Float32x4.store(t,12,m),t},i.scalar.multiply=function(t,e,n){var o=e[0],i=e[1],r=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],d=e[8],h=e[9],f=e[10],m=e[11],p=e[12],_=e[13],x=e[14],v=e[15],g=n[0],b=n[1],M=n[2],y=n[3];return t[0]=g*o+b*s+M*d+y*p,t[1]=g*i+b*l+M*h+y*_,t[2]=g*r+b*u+M*f+y*x,t[3]=g*a+b*c+M*m+y*v,g=n[4],b=n[5],M=n[6],y=n[7],t[4]=g*o+b*s+M*d+y*p,t[5]=g*i+b*l+M*h+y*_,t[6]=g*r+b*u+M*f+y*x,t[7]=g*a+b*c+M*m+y*v,g=n[8],b=n[9],M=n[10],y=n[11],t[8]=g*o+b*s+M*d+y*p,t[9]=g*i+b*l+M*h+y*_,t[10]=g*r+b*u+M*f+y*x,t[11]=g*a+b*c+M*m+y*v,g=n[12],b=n[13],M=n[14],y=n[15],t[12]=g*o+b*s+M*d+y*p,t[13]=g*i+b*l+M*h+y*_,t[14]=g*r+b*u+M*f+y*x,t[15]=g*a+b*c+M*m+y*v,t},i.multiply=o.USE_SIMD?i.SIMD.multiply:i.scalar.multiply,i.mul=i.multiply,i.scalar.translate=function(t,e,n){var o,i,r,a,s,l,u,c,d,h,f,m,p=n[0],_=n[1],x=n[2];return e===t?(t[12]=e[0]*p+e[4]*_+e[8]*x+e[12],t[13]=e[1]*p+e[5]*_+e[9]*x+e[13],t[14]=e[2]*p+e[6]*_+e[10]*x+e[14],t[15]=e[3]*p+e[7]*_+e[11]*x+e[15]):(o=e[0],i=e[1],r=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],d=e[8],h=e[9],f=e[10],m=e[11],t[0]=o,t[1]=i,t[2]=r,t[3]=a,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=d,t[9]=h,t[10]=f,t[11]=m,t[12]=o*p+s*_+d*x+e[12],t[13]=i*p+l*_+h*x+e[13],t[14]=r*p+u*_+f*x+e[14],t[15]=a*p+c*_+m*x+e[15]),t},i.SIMD.translate=function(t,e,n){var o=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4),r=SIMD.Float32x4.load(e,8),a=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4(n[0],n[1],n[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(s,0,0,0,0)),i=SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(s,1,1,1,1)),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(s,2,2,2,2));var l=SIMD.Float32x4.add(o,SIMD.Float32x4.add(i,SIMD.Float32x4.add(r,a)));return SIMD.Float32x4.store(t,12,l),t},i.translate=o.USE_SIMD?i.SIMD.translate:i.scalar.translate,i.scalar.scale=function(t,e,n){var o=n[0],i=n[1],r=n[2];return t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t[3]=e[3]*o,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.SIMD.scale=function(t,e,n){var o,i,r,a=SIMD.Float32x4(n[0],n[1],n[2],0);return o=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(a,0,0,0,0))),i=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(a,1,1,1,1))),r=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(a,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.scale=o.USE_SIMD?i.SIMD.scale:i.scalar.scale,i.rotate=function(t,e,n,i){var r,a,s,l,u,c,d,h,f,m,p,_,x,v,g,b,M,y,S,w,D,I,E,A,F=i[0],z=i[1],P=i[2],R=Math.sqrt(F*F+z*z+P*P);return Math.abs(R)<o.EPSILON?null:(F*=R=1/R,z*=R,P*=R,r=Math.sin(n),a=Math.cos(n),s=1-a,l=e[0],u=e[1],c=e[2],d=e[3],h=e[4],f=e[5],m=e[6],p=e[7],_=e[8],x=e[9],v=e[10],g=e[11],b=F*F*s+a,M=z*F*s+P*r,y=P*F*s-z*r,S=F*z*s-P*r,w=z*z*s+a,D=P*z*s+F*r,I=F*P*s+z*r,E=z*P*s-F*r,A=P*P*s+a,t[0]=l*b+h*M+_*y,t[1]=u*b+f*M+x*y,t[2]=c*b+m*M+v*y,t[3]=d*b+p*M+g*y,t[4]=l*S+h*w+_*D,t[5]=u*S+f*w+x*D,t[6]=c*S+m*w+v*D,t[7]=d*S+p*w+g*D,t[8]=l*I+h*E+_*A,t[9]=u*I+f*E+x*A,t[10]=c*I+m*E+v*A,t[11]=d*I+p*E+g*A,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},i.scalar.rotateX=function(t,e,n){var o=Math.sin(n),i=Math.cos(n),r=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],d=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=r*i+u*o,t[5]=a*i+c*o,t[6]=s*i+d*o,t[7]=l*i+h*o,t[8]=u*i-r*o,t[9]=c*i-a*o,t[10]=d*i-s*o,t[11]=h*i-l*o,t},i.SIMD.rotateX=function(t,e,n){var o=SIMD.Float32x4.splat(Math.sin(n)),i=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var r=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(r,i),SIMD.Float32x4.mul(a,o))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),SIMD.Float32x4.mul(r,o))),t},i.rotateX=o.USE_SIMD?i.SIMD.rotateX:i.scalar.rotateX,i.scalar.rotateY=function(t,e,n){var o=Math.sin(n),i=Math.cos(n),r=e[0],a=e[1],s=e[2],l=e[3],u=e[8],c=e[9],d=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*i-u*o,t[1]=a*i-c*o,t[2]=s*i-d*o,t[3]=l*i-h*o,t[8]=r*o+u*i,t[9]=a*o+c*i,t[10]=s*o+d*i,t[11]=l*o+h*i,t},i.SIMD.rotateY=function(t,e,n){var o=SIMD.Float32x4.splat(Math.sin(n)),i=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var r=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),SIMD.Float32x4.mul(a,o))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(r,o),SIMD.Float32x4.mul(a,i))),t},i.rotateY=o.USE_SIMD?i.SIMD.rotateY:i.scalar.rotateY,i.scalar.rotateZ=function(t,e,n){var o=Math.sin(n),i=Math.cos(n),r=e[0],a=e[1],s=e[2],l=e[3],u=e[4],c=e[5],d=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*i+u*o,t[1]=a*i+c*o,t[2]=s*i+d*o,t[3]=l*i+h*o,t[4]=u*i-r*o,t[5]=c*i-a*o,t[6]=d*i-s*o,t[7]=h*i-l*o,t},i.SIMD.rotateZ=function(t,e,n){var o=SIMD.Float32x4.splat(Math.sin(n)),i=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var r=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(r,i),SIMD.Float32x4.mul(a,o))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),SIMD.Float32x4.mul(r,o))),t},i.rotateZ=o.USE_SIMD?i.SIMD.rotateZ:i.scalar.rotateZ,i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromRotation=function(t,e,n){var i,r,a,s=n[0],l=n[1],u=n[2],c=Math.sqrt(s*s+l*l+u*u);return Math.abs(c)<o.EPSILON?null:(s*=c=1/c,l*=c,u*=c,i=Math.sin(e),r=Math.cos(e),a=1-r,t[0]=s*s*a+r,t[1]=l*s*a+u*i,t[2]=u*s*a-l*i,t[3]=0,t[4]=s*l*a-u*i,t[5]=l*l*a+r,t[6]=u*l*a+s*i,t[7]=0,t[8]=s*u*a+l*i,t[9]=l*u*a-s*i,t[10]=u*u*a+r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},i.fromXRotation=function(t,e){var n=Math.sin(e),o=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromYRotation=function(t,e){var n=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromZRotation=function(t,e){var n=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromRotationTranslation=function(t,e,n){var o=e[0],i=e[1],r=e[2],a=e[3],s=o+o,l=i+i,u=r+r,c=o*s,d=o*l,h=o*u,f=i*l,m=i*u,p=r*u,_=a*s,x=a*l,v=a*u;return t[0]=1-(f+p),t[1]=d+v,t[2]=h-x,t[3]=0,t[4]=d-v,t[5]=1-(c+p),t[6]=m+_,t[7]=0,t[8]=h+x,t[9]=m-_,t[10]=1-(c+f),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},i.fromRotationTranslationScale=function(t,e,n,o){var i=e[0],r=e[1],a=e[2],s=e[3],l=i+i,u=r+r,c=a+a,d=i*l,h=i*u,f=i*c,m=r*u,p=r*c,_=a*c,x=s*l,v=s*u,g=s*c,b=o[0],M=o[1],y=o[2];return t[0]=(1-(m+_))*b,t[1]=(h+g)*b,t[2]=(f-v)*b,t[3]=0,t[4]=(h-g)*M,t[5]=(1-(d+_))*M,t[6]=(p+x)*M,t[7]=0,t[8]=(f+v)*y,t[9]=(p-x)*y,t[10]=(1-(d+m))*y,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},i.fromRotationTranslationScaleOrigin=function(t,e,n,o,i){var r=e[0],a=e[1],s=e[2],l=e[3],u=r+r,c=a+a,d=s+s,h=r*u,f=r*c,m=r*d,p=a*c,_=a*d,x=s*d,v=l*u,g=l*c,b=l*d,M=o[0],y=o[1],S=o[2],w=i[0],D=i[1],I=i[2];return t[0]=(1-(p+x))*M,t[1]=(f+b)*M,t[2]=(m-g)*M,t[3]=0,t[4]=(f-b)*y,t[5]=(1-(h+x))*y,t[6]=(_+v)*y,t[7]=0,t[8]=(m+g)*S,t[9]=(_-v)*S,t[10]=(1-(h+p))*S,t[11]=0,t[12]=n[0]+w-(t[0]*w+t[4]*D+t[8]*I),t[13]=n[1]+D-(t[1]*w+t[5]*D+t[9]*I),t[14]=n[2]+I-(t[2]*w+t[6]*D+t[10]*I),t[15]=1,t},i.fromQuat=function(t,e){var n=e[0],o=e[1],i=e[2],r=e[3],a=n+n,s=o+o,l=i+i,u=n*a,c=o*a,d=o*s,h=i*a,f=i*s,m=i*l,p=r*a,_=r*s,x=r*l;return t[0]=1-d-m,t[1]=c+x,t[2]=h-_,t[3]=0,t[4]=c-x,t[5]=1-u-m,t[6]=f+p,t[7]=0,t[8]=h+_,t[9]=f-p,t[10]=1-u-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.frustum=function(t,e,n,o,i,r,a){var s=1/(n-e),l=1/(i-o),u=1/(r-a);return t[0]=2*r*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*r*l,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+o)*l,t[10]=(a+r)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*r*2*u,t[15]=0,t},i.perspective=function(t,e,n,o,i){var r=1/Math.tan(e/2),a=1/(o-i);return t[0]=r/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+o)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*o*a,t[15]=0,t},i.perspectiveFromFieldOfView=function(t,e,n,o){var i=Math.tan(e.upDegrees*Math.PI/180),r=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(a+s),u=2/(i+r);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(a-s)*l*.5,t[9]=(i-r)*u*.5,t[10]=o/(n-o),t[11]=-1,t[12]=0,t[13]=0,t[14]=o*n/(n-o),t[15]=0,t},i.ortho=function(t,e,n,o,i,r,a){var s=1/(e-n),l=1/(o-i),u=1/(r-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*s,t[13]=(i+o)*l,t[14]=(a+r)*u,t[15]=1,t},i.lookAt=function(t,e,n,r){var a,s,l,u,c,d,h,f,m,p,_=e[0],x=e[1],v=e[2],g=r[0],b=r[1],M=r[2],y=n[0],S=n[1],w=n[2];return Math.abs(_-y)<o.EPSILON&&Math.abs(x-S)<o.EPSILON&&Math.abs(v-w)<o.EPSILON?i.identity(t):(h=_-y,f=x-S,m=v-w,p=1/Math.sqrt(h*h+f*f+m*m),a=b*(m*=p)-M*(f*=p),s=M*(h*=p)-g*m,l=g*f-b*h,(p=Math.sqrt(a*a+s*s+l*l))?(a*=p=1/p,s*=p,l*=p):(a=0,s=0,l=0),u=f*l-m*s,c=m*a-h*l,d=h*s-f*a,(p=Math.sqrt(u*u+c*c+d*d))?(u*=p=1/p,c*=p,d*=p):(u=0,c=0,d=0),t[0]=a,t[1]=u,t[2]=h,t[3]=0,t[4]=s,t[5]=c,t[6]=f,t[7]=0,t[8]=l,t[9]=d,t[10]=m,t[11]=0,t[12]=-(a*_+s*x+l*v),t[13]=-(u*_+c*x+d*v),t[14]=-(h*_+f*x+m*v),t[15]=1,t)},i.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},t.exports=i},function(t,e,n){var o=n(1),i=n(4),r=n(7),a=n(8),s={create:function(){var t=new o.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}};s.rotationTo=function(){var t=r.create(),e=r.fromValues(1,0,0),n=r.fromValues(0,1,0);return function(o,i,a){var l=r.dot(i,a);return-.999999>l?(r.cross(t,e,i),r.length(t)<1e-6&&r.cross(t,n,i),r.normalize(t,t),s.setAxisAngle(o,t,Math.PI),o):l>.999999?(o[0]=0,o[1]=0,o[2]=0,o[3]=1,o):(r.cross(t,i,a),o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=1+l,s.normalize(o,o))}}(),s.setAxes=function(){var t=i.create();return function(e,n,o,i){return t[0]=o[0],t[3]=o[1],t[6]=o[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],s.normalize(e,s.fromMat3(e,t))}}(),s.clone=a.clone,s.fromValues=a.fromValues,s.copy=a.copy,s.set=a.set,s.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.setAxisAngle=function(t,e,n){n*=.5;var o=Math.sin(n);return t[0]=o*e[0],t[1]=o*e[1],t[2]=o*e[2],t[3]=Math.cos(n),t},s.add=a.add,s.multiply=function(t,e,n){var o=e[0],i=e[1],r=e[2],a=e[3],s=n[0],l=n[1],u=n[2],c=n[3];return t[0]=o*c+a*s+i*u-r*l,t[1]=i*c+a*l+r*s-o*u,t[2]=r*c+a*u+o*l-i*s,t[3]=a*c-o*s-i*l-r*u,t},s.mul=s.multiply,s.scale=a.scale,s.rotateX=function(t,e,n){n*=.5;var o=e[0],i=e[1],r=e[2],a=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=o*l+a*s,t[1]=i*l+r*s,t[2]=r*l-i*s,t[3]=a*l-o*s,t},s.rotateY=function(t,e,n){n*=.5;var o=e[0],i=e[1],r=e[2],a=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=o*l-r*s,t[1]=i*l+a*s,t[2]=r*l+o*s,t[3]=a*l-i*s,t},s.rotateZ=function(t,e,n){n*=.5;var o=e[0],i=e[1],r=e[2],a=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=o*l+i*s,t[1]=i*l-o*s,t[2]=r*l+a*s,t[3]=a*l-r*s,t},s.calculateW=function(t,e){var n=e[0],o=e[1],i=e[2];return t[0]=n,t[1]=o,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-o*o-i*i)),t},s.dot=a.dot,s.lerp=a.lerp,s.slerp=function(t,e,n,o){var i,r,a,s,l,u=e[0],c=e[1],d=e[2],h=e[3],f=n[0],m=n[1],p=n[2],_=n[3];return 0>(r=u*f+c*m+d*p+h*_)&&(r=-r,f=-f,m=-m,p=-p,_=-_),1-r>1e-6?(i=Math.acos(r),a=Math.sin(i),s=Math.sin((1-o)*i)/a,l=Math.sin(o*i)/a):(s=1-o,l=o),t[0]=s*u+l*f,t[1]=s*c+l*m,t[2]=s*d+l*p,t[3]=s*h+l*_,t},s.sqlerp=function(){var t=s.create(),e=s.create();return function(n,o,i,r,a,l){return s.slerp(t,o,a,l),s.slerp(e,i,r,l),s.slerp(n,t,e,2*l*(1-l)),n}}(),s.invert=function(t,e){var n=e[0],o=e[1],i=e[2],r=e[3],a=n*n+o*o+i*i+r*r,s=a?1/a:0;return t[0]=-n*s,t[1]=-o*s,t[2]=-i*s,t[3]=r*s,t},s.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},s.length=a.length,s.len=s.length,s.squaredLength=a.squaredLength,s.sqrLen=s.squaredLength,s.normalize=a.normalize,s.fromMat3=function(t,e){var n,o=e[0]+e[4]+e[8];if(o>0)n=Math.sqrt(o+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var r=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*r+r]-e[3*a+a]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*r+a]-e[3*a+r])*n,t[r]=(e[3*r+i]+e[3*i+r])*n,t[a]=(e[3*a+i]+e[3*i+a])*n}return t},s.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t.exports=s},function(t,e,n){var o=n(1),i={create:function(){var t=new o.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},clone:function(t){var e=new o.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},fromValues:function(t,e,n){var i=new o.ARRAY_TYPE(3);return i[0]=t,i[1]=e,i[2]=n,i},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},set:function(t,e,n,o){return t[0]=e,t[1]=n,t[2]=o,t},add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},subtract:function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}};i.sub=i.subtract,i.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},i.mul=i.multiply,i.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},i.div=i.divide,i.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},i.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},i.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},i.scaleAndAdd=function(t,e,n,o){return t[0]=e[0]+n[0]*o,t[1]=e[1]+n[1]*o,t[2]=e[2]+n[2]*o,t},i.distance=function(t,e){var n=e[0]-t[0],o=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+o*o+i*i)},i.dist=i.distance,i.squaredDistance=function(t,e){var n=e[0]-t[0],o=e[1]-t[1],i=e[2]-t[2];return n*n+o*o+i*i},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],n=t[1],o=t[2];return Math.sqrt(e*e+n*n+o*o)},i.len=i.length,i.squaredLength=function(t){var e=t[0],n=t[1],o=t[2];return e*e+n*n+o*o},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},i.normalize=function(t,e){var n=e[0],o=e[1],i=e[2],r=n*n+o*o+i*i;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},i.cross=function(t,e,n){var o=e[0],i=e[1],r=e[2],a=n[0],s=n[1],l=n[2];return t[0]=i*l-r*s,t[1]=r*a-o*l,t[2]=o*s-i*a,t},i.lerp=function(t,e,n,o){var i=e[0],r=e[1],a=e[2];return t[0]=i+o*(n[0]-i),t[1]=r+o*(n[1]-r),t[2]=a+o*(n[2]-a),t},i.hermite=function(t,e,n,o,i,r){var a=r*r,s=a*(2*r-3)+1,l=a*(r-2)+r,u=a*(r-1),c=a*(3-2*r);return t[0]=e[0]*s+n[0]*l+o[0]*u+i[0]*c,t[1]=e[1]*s+n[1]*l+o[1]*u+i[1]*c,t[2]=e[2]*s+n[2]*l+o[2]*u+i[2]*c,t},i.bezier=function(t,e,n,o,i,r){var a=1-r,s=a*a,l=r*r,u=s*a,c=3*r*s,d=3*l*a,h=l*r;return t[0]=e[0]*u+n[0]*c+o[0]*d+i[0]*h,t[1]=e[1]*u+n[1]*c+o[1]*d+i[1]*h,t[2]=e[2]*u+n[2]*c+o[2]*d+i[2]*h,t},i.random=function(t,e){e=e||1;var n=2*o.RANDOM()*Math.PI,i=2*o.RANDOM()-1,r=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*r,t[1]=Math.sin(n)*r,t[2]=i*e,t},i.transformMat4=function(t,e,n){var o=e[0],i=e[1],r=e[2],a=n[3]*o+n[7]*i+n[11]*r+n[15];return a=a||1,t[0]=(n[0]*o+n[4]*i+n[8]*r+n[12])/a,t[1]=(n[1]*o+n[5]*i+n[9]*r+n[13])/a,t[2]=(n[2]*o+n[6]*i+n[10]*r+n[14])/a,t},i.transformMat3=function(t,e,n){var o=e[0],i=e[1],r=e[2];return t[0]=o*n[0]+i*n[3]+r*n[6],t[1]=o*n[1]+i*n[4]+r*n[7],t[2]=o*n[2]+i*n[5]+r*n[8],t},i.transformQuat=function(t,e,n){var o=e[0],i=e[1],r=e[2],a=n[0],s=n[1],l=n[2],u=n[3],c=u*o+s*r-l*i,d=u*i+l*o-a*r,h=u*r+a*i-s*o,f=-a*o-s*i-l*r;return t[0]=c*u+f*-a+d*-l-h*-s,t[1]=d*u+f*-s+h*-a-c*-l,t[2]=h*u+f*-l+c*-s-d*-a,t},i.rotateX=function(t,e,n,o){var i=[],r=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],r[0]=i[0],r[1]=i[1]*Math.cos(o)-i[2]*Math.sin(o),r[2]=i[1]*Math.sin(o)+i[2]*Math.cos(o),t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t},i.rotateY=function(t,e,n,o){var i=[],r=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],r[0]=i[2]*Math.sin(o)+i[0]*Math.cos(o),r[1]=i[1],r[2]=i[2]*Math.cos(o)-i[0]*Math.sin(o),t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t},i.rotateZ=function(t,e,n,o){var i=[],r=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],r[0]=i[0]*Math.cos(o)-i[1]*Math.sin(o),r[1]=i[0]*Math.sin(o)+i[1]*Math.cos(o),r[2]=i[2],t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t},i.forEach=function(){var t=i.create();return function(e,n,o,i,r,a){var s,l;for(n||(n=3),o||(o=0),l=i?Math.min(i*n+o,e.length):e.length,s=o;l>s;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],r(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),i.angle=function(t,e){var n=i.fromValues(t[0],t[1],t[2]),o=i.fromValues(e[0],e[1],e[2]);i.normalize(n,n),i.normalize(o,o);var r=i.dot(n,o);return r>1?0:Math.acos(r)},i.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},t.exports=i},function(t,e,n){var o=n(1),i={create:function(){var t=new o.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},clone:function(t){var e=new o.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},fromValues:function(t,e,n,i){var r=new o.ARRAY_TYPE(4);return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},set:function(t,e,n,o,i){return t[0]=e,t[1]=n,t[2]=o,t[3]=i,t},add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},subtract:function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}};i.sub=i.subtract,i.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},i.mul=i.multiply,i.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t},i.div=i.divide,i.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},i.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},i.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},i.scaleAndAdd=function(t,e,n,o){return t[0]=e[0]+n[0]*o,t[1]=e[1]+n[1]*o,t[2]=e[2]+n[2]*o,t[3]=e[3]+n[3]*o,t},i.distance=function(t,e){var n=e[0]-t[0],o=e[1]-t[1],i=e[2]-t[2],r=e[3]-t[3];return Math.sqrt(n*n+o*o+i*i+r*r)},i.dist=i.distance,i.squaredDistance=function(t,e){var n=e[0]-t[0],o=e[1]-t[1],i=e[2]-t[2],r=e[3]-t[3];return n*n+o*o+i*i+r*r},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],n=t[1],o=t[2],i=t[3];return Math.sqrt(e*e+n*n+o*o+i*i)},i.len=i.length,i.squaredLength=function(t){var e=t[0],n=t[1],o=t[2],i=t[3];return e*e+n*n+o*o+i*i},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},i.normalize=function(t,e){var n=e[0],o=e[1],i=e[2],r=e[3],a=n*n+o*o+i*i+r*r;return a>0&&(a=1/Math.sqrt(a),t[0]=n*a,t[1]=o*a,t[2]=i*a,t[3]=r*a),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},i.lerp=function(t,e,n,o){var i=e[0],r=e[1],a=e[2],s=e[3];return t[0]=i+o*(n[0]-i),t[1]=r+o*(n[1]-r),t[2]=a+o*(n[2]-a),t[3]=s+o*(n[3]-s),t},i.random=function(t,e){return e=e||1,t[0]=o.RANDOM(),t[1]=o.RANDOM(),t[2]=o.RANDOM(),t[3]=o.RANDOM(),i.normalize(t,t),i.scale(t,t,e),t},i.transformMat4=function(t,e,n){var o=e[0],i=e[1],r=e[2],a=e[3];return t[0]=n[0]*o+n[4]*i+n[8]*r+n[12]*a,t[1]=n[1]*o+n[5]*i+n[9]*r+n[13]*a,t[2]=n[2]*o+n[6]*i+n[10]*r+n[14]*a,t[3]=n[3]*o+n[7]*i+n[11]*r+n[15]*a,t},i.transformQuat=function(t,e,n){var o=e[0],i=e[1],r=e[2],a=n[0],s=n[1],l=n[2],u=n[3],c=u*o+s*r-l*i,d=u*i+l*o-a*r,h=u*r+a*i-s*o,f=-a*o-s*i-l*r;return t[0]=c*u+f*-a+d*-l-h*-s,t[1]=d*u+f*-s+h*-a-c*-l,t[2]=h*u+f*-l+c*-s-d*-a,t[3]=e[3],t},i.forEach=function(){var t=i.create();return function(e,n,o,i,r,a){var s,l;for(n||(n=4),o||(o=0),l=i?Math.min(i*n+o,e.length):e.length,s=o;l>s;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],r(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}(),i.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t.exports=i},function(t,e,n){var o=n(1),i={create:function(){var t=new o.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},clone:function(t){var e=new o.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},fromValues:function(t,e){var n=new o.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t},set:function(t,e,n){return t[0]=e,t[1]=n,t},add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},subtract:function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}};i.sub=i.subtract,i.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},i.mul=i.multiply,i.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},i.div=i.divide,i.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},i.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},i.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},i.scaleAndAdd=function(t,e,n,o){return t[0]=e[0]+n[0]*o,t[1]=e[1]+n[1]*o,t},i.distance=function(t,e){var n=e[0]-t[0],o=e[1]-t[1];return Math.sqrt(n*n+o*o)},i.dist=i.distance,i.squaredDistance=function(t,e){var n=e[0]-t[0],o=e[1]-t[1];return n*n+o*o},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},i.len=i.length,i.squaredLength=function(t){var e=t[0],n=t[1];return e*e+n*n},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},i.normalize=function(t,e){var n=e[0],o=e[1],i=n*n+o*o;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},i.cross=function(t,e,n){var o=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=o,t},i.lerp=function(t,e,n,o){var i=e[0],r=e[1];return t[0]=i+o*(n[0]-i),t[1]=r+o*(n[1]-r),t},i.random=function(t,e){e=e||1;var n=2*o.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},i.transformMat2=function(t,e,n){var o=e[0],i=e[1];return t[0]=n[0]*o+n[2]*i,t[1]=n[1]*o+n[3]*i,t},i.transformMat2d=function(t,e,n){var o=e[0],i=e[1];return t[0]=n[0]*o+n[2]*i+n[4],t[1]=n[1]*o+n[3]*i+n[5],t},i.transformMat3=function(t,e,n){var o=e[0],i=e[1];return t[0]=n[0]*o+n[3]*i+n[6],t[1]=n[1]*o+n[4]*i+n[7],t},i.transformMat4=function(t,e,n){var o=e[0],i=e[1];return t[0]=n[0]*o+n[4]*i+n[12],t[1]=n[1]*o+n[5]*i+n[13],t},i.forEach=function(){var t=i.create();return function(e,n,o,i,r,a){var s,l;for(n||(n=2),o||(o=0),l=i?Math.min(i*n+o,e.length):e.length,s=o;l>s;s+=n)t[0]=e[s],t[1]=e[s+1],r(t,t,a),e[s]=t[0],e[s+1]=t[1];return e}}(),i.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},t.exports=i}])},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return o});var o=o||{};o.EPSILON=1e-6,o.BVHVector3=function(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0},o.BVHVector3.prototype={constructor:o.BVHVector3,copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setFromArray:function(t,e){this.x=t[e],this.y=t[e+1],this.z=t[e+2]},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},cross:function(t){var e=this.x,n=this.y,o=this.z;return this.x=n*t.z-o*t.y,this.y=o*t.x-e*t.z,this.z=e*t.y-n*t.x,this},crossVectors:function(t,e){var n=t.x,o=t.y,i=t.z,r=e.x,a=e.y,s=e.z;return this.x=o*s-i*a,this.y=i*r-n*s,this.z=n*a-o*r,this},clone:function(){return new o.BVHVector3(this.x,this.y,this.z)}},o.BVH=function(t,e){var n=[];n.length=9*t.length;for(var i=0;i<t.length;i++){var r=t[i][0],a=t[i][1],s=t[i][2];n[9*i]=r.x,n[9*i+1]=r.y,n[9*i+2]=r.z,n[9*i+3]=a.x,n[9*i+4]=a.y,n[9*i+5]=a.z,n[9*i+6]=s.x,n[9*i+7]=s.y,n[9*i+8]=s.z}this._trianglesArray=n,this._maxTrianglesPerNode=e||10,this._bboxArray=this.calcBoundingBoxes(n),this._bboxHelper=new Float32Array(this._bboxArray.length),this._bboxHelper.set(this._bboxArray);var l=n.length/9,u=this.calcExtents(0,l,o.EPSILON);for(this._rootNode=new o.BVHNode(u[0],u[1],0,l,0),this._nodesToSplit=[this._rootNode];this._nodesToSplit.length>0;){var c=this._nodesToSplit.pop();this.splitNode(c)}},o.BVH.prototype.intersectRay=function(t,e,n){for(var i,r=[this._rootNode],a=[],s=[],l=new o.BVHVector3(1/e.x,1/e.y,1/e.z);r.length>0;){var u=r.pop();if(o.BVH.intersectNodeBox(t,l,u))for(u._node0&&r.push(u._node0),u._node1&&r.push(u._node1),i=u._startIndex;i<u._endIndex;i++)a.push(this._bboxArray[7*i])}var c=new o.BVHVector3,d=new o.BVHVector3,h=new o.BVHVector3,f=new o.BVHVector3(t.x,t.y,t.z),m=new o.BVHVector3(e.x,e.y,e.z);for(i=0;i<a.length;i++){var p=a[i];c.setFromArray(this._trianglesArray,9*p),d.setFromArray(this._trianglesArray,9*p+3),h.setFromArray(this._trianglesArray,9*p+6);var _=o.BVH.intersectRayTriangle(c,d,h,f,m,n);_&&s.push({triangle:[c.clone(),d.clone(),h.clone()],triangleIndex:p,intersectionPoint:_.point,backface:_.backface})}return s},o.BVH.prototype.calcBoundingBoxes=function(t){for(var e,n,i,r,a,s,l,u,c,d,h,f,m,p,_,x=t.length/9,v=new Float32Array(7*x),g=0;g<x;g++)e=t[9*g],n=t[9*g+1],i=t[9*g+2],r=t[9*g+3],a=t[9*g+4],s=t[9*g+5],l=t[9*g+6],u=t[9*g+7],c=t[9*g+8],d=Math.min(Math.min(e,r),l),h=Math.min(Math.min(n,a),u),f=Math.min(Math.min(i,s),c),m=Math.max(Math.max(e,r),l),p=Math.max(Math.max(n,a),u),_=Math.max(Math.max(i,s),c),o.BVH.setBox(v,g,g,d,h,f,m,p,_);return v},o.BVH.prototype.calcExtents=function(t,e,n){if(n=n||0,t>=e)return[{x:0,y:0,z:0},{x:0,y:0,z:0}];for(var o=Number.MAX_VALUE,i=Number.MAX_VALUE,r=Number.MAX_VALUE,a=-Number.MAX_VALUE,s=-Number.MAX_VALUE,l=-Number.MAX_VALUE,u=t;u<e;u++)o=Math.min(this._bboxArray[7*u+1],o),i=Math.min(this._bboxArray[7*u+2],i),r=Math.min(this._bboxArray[7*u+3],r),a=Math.max(this._bboxArray[7*u+4],a),s=Math.max(this._bboxArray[7*u+5],s),l=Math.max(this._bboxArray[7*u+6],l);return[{x:o-n,y:i-n,z:r-n},{x:a+n,y:s+n,z:l+n}]},o.BVH.prototype.splitNode=function(t){if(!(t.elementCount()<=this._maxTrianglesPerNode||0===t.elementCount())){var e=t._startIndex,n=t._endIndex,i=[[],[],[]],r=[[],[],[]],a=[t.centerX(),t.centerY(),t.centerZ()],s=[t._extentsMax.x-t._extentsMin.x,t._extentsMax.y-t._extentsMin.y,t._extentsMax.z-t._extentsMin.z],l=[];l.length=3;for(var u=e;u<n;u++){l[0]=.5*(this._bboxArray[7*u+1]+this._bboxArray[7*u+4]),l[1]=.5*(this._bboxArray[7*u+2]+this._bboxArray[7*u+5]),l[2]=.5*(this._bboxArray[7*u+3]+this._bboxArray[7*u+6]);for(var c=0;c<3;c++)l[c]<a[c]?i[c].push(u):r[c].push(u)}var d=[];if(d.length=3,d[0]=0===i[0].length||0===r[0].length,d[1]=0===i[1].length||0===r[1].length,d[2]=0===i[2].length||0===r[2].length,!(d[0]&&d[1]&&d[2])){var h,f,m=[0,1,2];for(m.sort(function(t,e){return s[e]-s[t]}),c=0;c<3;c++){var p=m[c];if(!d[p]){h=i[p],f=r[p];break}}var _,x=e,v=x+h.length,g=v,b=n,M=t._startIndex,y=h.concat(f);for(u=0;u<y.length;u++)_=y[u],o.BVH.copyBox(this._bboxArray,_,this._bboxHelper,M),M++;var S=this._bboxHelper.subarray(7*t._startIndex,7*t._endIndex);this._bboxArray.set(S,7*t._startIndex);var w=this.calcExtents(x,v,o.EPSILON),D=this.calcExtents(g,b,o.EPSILON),I=new o.BVHNode(w[0],w[1],x,v,t._level+1),E=new o.BVHNode(D[0],D[1],g,b,t._level+1);t._node0=I,t._node1=E,t.clearShapes(),this._nodesToSplit.push(I),this._nodesToSplit.push(E)}}},o.BVH._calcTValues=function(t,e,n,o){var i={min:0,max:0};return o>=0?(i.min=(t-n)*o,i.max=(e-n)*o):(i.min=(e-n)*o,i.max=(t-n)*o),i},o.BVH.intersectNodeBox=function(t,e,n){var i=o.BVH._calcTValues(n._extentsMin.x,n._extentsMax.x,t.x,e.x),r=o.BVH._calcTValues(n._extentsMin.y,n._extentsMax.y,t.y,e.y);if(i.min>r.max||r.min>i.max)return!1;(r.min>i.min||i.min!=i.min)&&(i.min=r.min),(r.max<i.max||i.max!=i.max)&&(i.max=r.max);var a=o.BVH._calcTValues(n._extentsMin.z,n._extentsMax.z,t.z,e.z);return!(i.min>a.max||a.min>i.max)&&((a.min>i.min||i.min!=i.min)&&(i.min=a.min),(a.max<i.max||i.max!=i.max)&&(i.max=a.max),!(i.max<0))},o.BVH.intersectRayTriangle=function(){var t=new o.BVHVector3,e=new o.BVHVector3,n=new o.BVHVector3,i=new o.BVHVector3;return function(r,a,s,l,u,c){e.subVectors(a,r),n.subVectors(s,r),i.crossVectors(e,n);var d,h=u.dot(i);if(h>0)d=1;else{if(!(h<0))return null;d=-1,h=-h}t.subVectors(l,r);var f=d*u.dot(n.crossVectors(t,n));if(f<0)return null;var m=d*u.dot(e.cross(t));if(m<0)return null;if(f+m>h)return null;var p=-d*t.dot(i);if(p<0)return null;var _=p/h;return{point:(new o.BVHVector3).copy(u).multiplyScalar(_).add(l),backface:1===d}}}(),o.BVH.setBox=function(t,e,n,o,i,r,a,s,l){t[7*e]=n,t[7*e+1]=o,t[7*e+2]=i,t[7*e+3]=r,t[7*e+4]=a,t[7*e+5]=s,t[7*e+6]=l},o.BVH.copyBox=function(t,e,n,o){n[7*o]=t[7*e],n[7*o+1]=t[7*e+1],n[7*o+2]=t[7*e+2],n[7*o+3]=t[7*e+3],n[7*o+4]=t[7*e+4],n[7*o+5]=t[7*e+5],n[7*o+6]=t[7*e+6]},o.BVH.getBox=function(t,e,n){n.triangleId=t[7*e],n.minX=t[7*e+1],n.minY=t[7*e+2],n.minZ=t[7*e+3],n.maxX=t[7*e+4],n.maxY=t[7*e+5],n.maxZ=t[7*e+6]},o.BVHNode=function(t,e,n,o,i){this._extentsMin=t,this._extentsMax=e,this._startIndex=n,this._endIndex=o,this._level=i,this._node0=null,this._node1=null},o.BVHNode.prototype.elementCount=function(){return this._endIndex-this._startIndex},o.BVHNode.prototype.centerX=function(){return.5*(this._extentsMin.x+this._extentsMax.x)},o.BVHNode.prototype.centerY=function(){return.5*(this._extentsMin.y+this._extentsMax.y)},o.BVHNode.prototype.centerZ=function(){return.5*(this._extentsMin.z+this._extentsMax.z)},o.BVHNode.prototype.clearShapes=function(){this._startIndex=-1,this._endIndex=-1},o.BVHNode.calcBoundingSphereRadius=function(t,e){var n=.5*(t.x+e.x),o=.5*(t.y+e.y),i=.5*(t.z+e.z),r=(n-t.x)*(n-t.x)+(o-t.y)*(o-t.y)+(i-t.z)*(i-t.z),a=(n-e.x)*(n-e.x)+(o-e.y)*(o-e.y)+(i-e.z)*(i-e.z);return Math.sqrt(Math.max(r,a))},void 0!==t&&t.exports&&(t.exports.BVH=o.BVH,t.exports.intersectRay=o.intersectRay)}).call(this,n(3)(t))},function(t,e,n){"use strict";n.r(e);var o,i=n(0),r=45;function a(t,e,n,o,i){void 0!==t&&(this.zoom_smoothness=t),void 0!==e&&(this.speed=e),void 0!==n&&(this.startingZoom=n),void 0!==o&&(this.smoothDeltaTimeCheck=o),void 0!==i&&(this.rotationSensitivity=i)}function s(t,e){if(this.smoothDeltaTimeCheck&&t<=.03333&&(t<.01||(t=.016)),this.zoomdefined||(this.startingZoom=r,this.zoomdefined=!0),this.autoCentered)return function(t,e,n){this.yaw+=this.deltaRot[0]*e,this.pitch-=this.deltaRot[1]*e,this.autoRotate&&(this.yaw+=this.autoRotateSpeed/180*Math.PI*t);this.deltaRot[0]-=this.deltaRot[0]*e,this.deltaRot[1]-=this.deltaRot[1]*e,this.pitch>1.565&&(this.pitch=1.565);this.pitch<-1.565&&(this.pitch=-1.565);if(Math.abs(this.deltazoom)>0){var o=this.deltazoom*this.zoom_smoothness;this.deltazoom<0&&(this.deltazoom=this.deltazoom<-.01?this.deltazoom-o:0),this.deltazoom>0&&(this.deltazoom=this.deltazoom>.01?this.deltazoom-o:0),(r+=o)<44.5&&(r=44.5),r>this.startingZoom&&(r=this.startingZoom)}var a=Math.cos(this.yaw)*Math.cos(this.pitch)*n,s=Math.sin(this.yaw)*Math.cos(this.pitch)*n,l=Math.sin(this.pitch)*n;if(this.pos[0]=a+this.look[0],this.pos[1]=l+this.look[1],this.pos[2]=-s+this.look[2],i.mat4.lookAt(this.lookAt,this.pos,this.look,this.up),0!=this.depth_of_field_transform_count){var u=6.28*this.depth_of_field_transform_count/10,c=this.yaw+Math.cos(u)/150,d=this.pitch+Math.sin(u)/150,a=Math.cos(c)*Math.cos(d)*n,s=Math.sin(c)*Math.cos(d)*n,l=Math.sin(d)*n;this.pos[0]=a+this.look[0],this.pos[1]=l+this.look[1],this.pos[2]=-s+this.look[2],i.mat4.lookAt(this.lookAt,this.pos,this.look,this.up)}return this.lookAt}.call(this,t,e,this.radius);if((this.pressedKeys.w||this.pressedKeys.ua)&&(this.pos[0]+=t*this.speed*this.front[0],this.pos[1]+=t*this.speed*this.front[1],this.pos[2]+=t*this.speed*this.front[2]),(this.pressedKeys.s||this.pressedKeys.da)&&(this.pos[0]-=t*this.speed*this.front[0],this.pos[1]-=t*this.speed*this.front[1],this.pos[2]-=t*this.speed*this.front[2]),(this.pressedKeys.d||this.pressedKeys.ra)&&(this.frontCross=i.vec3.cross(this.frontCross,this.front,this.up),i.vec3.normalize(this.frontCross,this.frontCross),this.pos[0]+=t*this.speed*this.frontCross[0],this.pos[1]+=t*this.speed*this.frontCross[1],this.pos[2]+=t*this.speed*this.frontCross[2]),(this.pressedKeys.a||this.pressedKeys.la)&&(this.frontCross=i.vec3.cross(this.frontCross,this.front,this.up),i.vec3.normalize(this.frontCross,this.frontCross),this.pos[0]-=t*this.speed*this.frontCross[0],this.pos[1]-=t*this.speed*this.frontCross[1],this.pos[2]-=t*this.speed*this.frontCross[2]),this.pressedKeys.space&&(this.pos[0]+=t*this.speed*this.up[0],this.pos[1]+=t*this.speed*this.up[1],this.pos[2]+=t*this.speed*this.up[2]),this.pressedKeys.shift&&(this.pos[0]-=t*this.speed*this.up[0],this.pos[1]-=t*this.speed*this.up[1],this.pos[2]-=t*this.speed*this.up[2]),this.yaw+=this.deltaRot[0]*e,this.pitch-=this.deltaRot[1]*e,this.deltaRot[0]-=this.deltaRot[0]*e,this.deltaRot[1]-=this.deltaRot[1]*e,this.pitch>1.565&&(this.pitch=1.565),this.pitch<-1.565&&(this.pitch=-1.565),this.front[0]=Math.cos(this.yaw)*Math.cos(this.pitch),this.front[1]=Math.sin(this.pitch),this.front[2]=Math.sin(this.yaw)*Math.cos(this.pitch),i.vec3.normalize(this.front,this.front),Math.abs(this.deltazoom)>0){var n=this.deltazoom*this.zoom_smoothness;this.deltazoom<0&&(this.deltazoom=this.deltazoom<-.01?this.deltazoom-n:0),this.deltazoom>0&&(this.deltazoom=this.deltazoom>.01?this.deltazoom-n:0),(r+=n)<44.5&&(r=44.5),r>this.startingZoom&&(r=this.startingZoom)}return this.dir[0]=this.pos[0]+this.front[0],this.dir[1]=this.pos[1]+this.front[1],this.dir[2]=this.pos[2]+this.front[2],i.mat4.lookAt(this.lookAt,this.pos,this.dir,this.up),this.lookAt}function l(t){switch(t.keyCode){case 87:this.pressedKeys.w=!0;break;case 65:this.pressedKeys.a=!0;break;case 83:this.pressedKeys.s=!0;break;case 68:this.pressedKeys.d=!0;break;case 32:this.pressedKeys.space=!0;break;case 16:this.pressedKeys.shift=!0;break;case 37:this.pressedKeys.la=!0;break;case 38:this.pressedKeys.ua=!0;break;case 39:this.pressedKeys.ra=!0;break;case 40:this.pressedKeys.da=!0}}function u(t){switch(t.keyCode){case 87:this.pressedKeys.w=!1;break;case 65:this.pressedKeys.a=!1;break;case 83:this.pressedKeys.s=!1;break;case 68:this.pressedKeys.d=!1;break;case 32:this.pressedKeys.space=!1;break;case 16:this.pressedKeys.shift=!1;break;case 37:this.pressedKeys.la=!1;break;case 38:this.pressedKeys.ua=!1;break;case 39:this.pressedKeys.ra=!1;break;case 40:this.pressedKeys.da=!1}}function c(t){this.dragging&&(this.deltaRot[0]+=(t.clientX-this.lastPos[0])*this.rotationSensitivity,this.deltaRot[1]+=(t.clientY-this.lastPos[1])*this.rotationSensitivity,this.lastPos[0]=t.clientX,this.lastPos[1]=t.clientY)}function d(t){this.dragging&&(this.deltaRot[0]+=(t.touches[0].clientX-this.lastPos[0])*this.rotationSensitivity,this.deltaRot[1]+=(t.touches[0].clientY-this.lastPos[1])*this.rotationSensitivity,this.lastPos[0]=t.touches[0].clientX,this.lastPos[1]=t.touches[0].clientY)}function h(t){1==t.which&&(this.lastPos[0]=t.clientX,this.lastPos[1]=t.clientY,this.dragging=!0)}function f(t){this.dragging=!1}function m(t){this.lastPos[0]=t.touches[0].clientX,this.lastPos[1]=t.touches[0].clientY,this.dragging=!0}function p(t){this.dragging=!1}function _(t){var e=t.wheelDelta?t.wheelDelta:-t.detail;this.deltazoom+=e>0?-.15:.15}function x(t,e,n){o=t;var i=v(e,"vert"),r=v(n,"frag"),a=o.createProgram();return o.attachShader(a,i),o.attachShader(a,r),o.linkProgram(a),o.getProgramParameter(a,o.LINK_STATUS)?a:(alert("Could not initialise shaders"),null)}function v(t,e){var n;if("frag"==e)n=o.createShader(o.FRAGMENT_SHADER);else{if("vert"!=e)return null;n=o.createShader(o.VERTEX_SHADER)}return o.shaderSource(n,t),o.compileShader(n),o.getShaderParameter(n,o.COMPILE_STATUS)?n:(alert(o.getShaderInfoLog(n)+"  "+e),console.log(t),null)}const g="\nattribute vec4 aPosition;\nattribute vec4 aColor;\n\nuniform mat4 uPerspective;\nuniform mat4 uModel;\nuniform mat4 uView;\n\nvarying vec4 Color;\nvarying vec2 UVPlanePos;\n\nvoid main() {\n    gl_Position  = uPerspective * uView * uModel * vec4(aPosition.xyz, 1.0); \n\n    Color = vec4(aColor);\n\n    UVPlanePos = (aPosition.xz / 3.0) * 0.5 + 0.5;\n}",b="\nprecision mediump float;\n\nuniform int       uUseTexture;\nuniform sampler2D uTexture;\n\nuniform float uRayCount;\nuniform float uResolution;\n\nvarying vec4 Color;\nvarying vec2 UVPlanePos;\n\n\nvec4 filterTexture() {\n    float fract_x = fract(UVPlanePos.x * uResolution) - 0.5;\n    float fract_y = fract(UVPlanePos.y * uResolution) - 0.5;\n\n    float offset = 1.0 / uResolution;\n    vec4 center  = texture2D(uTexture, UVPlanePos + vec2(0.0, 0.0));\n\n    vec4 top     = texture2D(uTexture, UVPlanePos + vec2(0.0, +offset));\n    vec4 bottom  = texture2D(uTexture, UVPlanePos + vec2(0.0, -offset));\n    vec4 left    = texture2D(uTexture, UVPlanePos + vec2(-offset, 0.0));\n    vec4 right   = texture2D(uTexture, UVPlanePos + vec2(+offset, 0.0));\n\n    vec4 col = vec4(center);\n\n    // if (fract_x < 0.0) col = col * (1.0 + fract_x) + left * (-fract_x);  \n    // if (fract_x > 0.0) col = col * (1.0 - fract_x) + right * (fract_x);  \n    // if (fract_y < 0.0) col = col * (1.0 + fract_y) + bottom * (-fract_y);  \n    // if (fract_y > 0.0) col = col * (1.0 - fract_y) + top * (fract_y);  \n\n    return col;\n}\n\n\nvoid main() {\n    gl_FragColor = Color; \n\n    if (uUseTexture > 0) {\n        vec4 col = filterTexture() / uRayCount;\n        col.xyz *= 25000.0;\n        col.xyz += vec3(0.04);\n        col.a = 1.0;\n        \n        gl_FragColor = col;\n    } \n}",M="\nattribute vec4 aPosition;\nattribute vec4 aNormal;\n\nuniform mat4 uPerspective;\nuniform mat4 uModel;\nuniform mat4 uView;\n\nvarying vec4 Normal;\nvarying vec4 Position;\nvarying vec2 UVPlanePos;\n\nvoid main() {\n    gl_Position  = uPerspective * uView * uModel * vec4(aPosition.xyz, 1.0); \n\n    Normal = mat4(mat3(uModel)) * aNormal;\n    Position = uModel * vec4(aPosition.xyz, 1.0); \n\n    UVPlanePos = (aPosition.xz / 3.0) * 0.5 + 0.5;\n}",y="\nprecision mediump float;\n\nuniform int       uUseTexture;\nuniform sampler2D uTexture;\nuniform samplerCube uCubeTexture;\n\nuniform vec3 uEyePosition;\nuniform vec3 uLightPosition;\nuniform vec3 uLightDirection;\nuniform float uLightSize;\nuniform vec3 uLightPlaneU;\nuniform vec3 uLightPlaneV;\n\nuniform float uRayCount;\nuniform float uUseSkybox;\nuniform float uIOR;\nuniform float uDispersion;\nuniform float uRefractiveLightReflection;\n\nvarying vec4 Normal;\nvarying vec4 Position;\nvarying vec2 UVPlanePos;\n\nvoid main() {\n    vec3 normal = normalize(Normal.xyz);\n    vec3 lightDir = normalize(uLightPosition - Position.xyz);\n    vec3 viewDir  = normalize(uEyePosition - vec3(Position));\n\n    float fresnel = pow((1.0 - dot(normal, viewDir)),   1.6) * 1.0 + 0.65;  \n    // float fresnel = 1.0;\n\n    vec3 h = normalize(viewDir + lightDir);\n    float specular = pow(   max(dot(h, normal), 0.0),    24.0);\n\n\n    // compute intersection along LIGHT plane to calculate specular reflections\n    {\n        vec3 reflectedDir = reflect(-viewDir, normal);\n        vec3 planeHitPoint = vec3(999.0);\n\n        vec3 rayDirection = reflectedDir;\n        vec3 rayOrigin    = Position.xyz;\n        vec3 planeNormal  = uLightDirection;\n\n        float denominator = dot(planeNormal, rayDirection);\n        float t = -1.0;\n        if (abs(denominator) > 0.0001) {\n            vec3 difference = uLightPosition - rayOrigin;\n            t = dot(difference, planeNormal) / denominator;\n\n            if (t > 0.0001) {\n                planeHitPoint = rayOrigin + rayDirection * t;\n\n                vec3 hitVec = planeHitPoint - uLightPosition;\n                float a = abs(dot( hitVec, uLightPlaneU));\n                float b = abs(dot( hitVec, uLightPlaneV));\n                if( 0.0 <= a && a <= uLightSize && 0.0 <= b && b <= uLightSize) {\n                    specular = 1.2;\n                }\n            }\n        }\n    }\n    // compute intersection along LIGHT plane to calculate specular reflections - END\n\n\n\n\n\n\n    \n\n    // compute intersection along plane\n    vec3 refractedDir = refract(-viewDir, normal, 1.0 / uIOR);\n    vec3 planeHitPoint = vec3(999.0);\n\n    vec3 rayDirection = refractedDir;\n    vec3 rayOrigin    = Position.xyz;\n    vec3 planeNormal  = vec3(0.0, 1.0, 0.0);\n\n    float denominator = dot(planeNormal, rayDirection);\n    float t = -1.0;\n    if (abs(denominator) > 0.0001) {\n        vec3 difference = vec3(0.0) - rayOrigin;\n        t = dot(difference, planeNormal) / denominator;\n\n        if (t > 0.0001) {\n            planeHitPoint = rayOrigin + rayDirection * t;\n            planeHitPoint.y = 0.0;\n        }\n    }\n    // compute intersection along plane - END\n\n\n    vec3 refractColor = vec3(0.0);\n    vec2 planeUV = (planeHitPoint.xz / 3.0) * 0.5 + 0.5; \n    if (planeUV.x < 1.0 && planeUV.x > 0.0 && planeUV.y < 1.0 && planeUV.y > 0.0) {\n        refractColor = texture2D(uTexture, planeUV).rgb / uRayCount;\n        refractColor *= 25000.0;\n    }\n\n    // use environment map if we miss the surface\n    if (t < 0.0 && uUseSkybox > 0.0) {\n        refractColor = vec3(\n                         textureCube(uCubeTexture, rayDirection).r,\n                         textureCube(uCubeTexture, rayDirection + vec3(uDispersion)).g,\n                         textureCube(uCubeTexture, rayDirection + vec3(uDispersion * 2.0)).b\n                       ) * 0.7;\n    }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    // compute intersection along LIGHT plane to calculate reflections from refraction\n    if (uRefractiveLightReflection > 0.0)\n    {\n        vec3 reflectedDir = refract(-viewDir, normal, 1.0 / uIOR);\n        vec3 planeHitPoint = vec3(999.0);\n\n        vec3 rayDirection = reflectedDir;\n        vec3 rayOrigin    = Position.xyz;\n        vec3 planeNormal  = uLightDirection;\n\n        float denominator = dot(planeNormal, rayDirection);\n        float tt = -1.0;\n        if (abs(denominator) > 0.0001) {\n            vec3 difference = uLightPosition - rayOrigin;\n            tt = dot(difference, planeNormal) / denominator;\n\n            if (tt > 0.0001 && t <= 0.0) {\n                planeHitPoint = rayOrigin + rayDirection * tt;\n\n                vec3 hitVec = planeHitPoint - uLightPosition;\n                float a = abs(dot( hitVec, uLightPlaneU));\n                float b = abs(dot( hitVec, uLightPlaneV));\n                if( 0.0 <= a && a <= uLightSize && 0.0 <= b && b <= uLightSize) {\n                    specular = 1.2;\n                }\n            }\n        }\n    }\n    // compute intersection along LIGHT plane to calculate reflections from refraction - END\n\n\n\n\n\n\n\n\n\n\n\n\n    gl_FragColor = vec4(vec3(refractColor * fresnel + specular * fresnel - vec3(0.05)), 1.0); \n}",S="\nattribute vec4 aPosition;\n\nuniform mat4 uPerspective;\nuniform mat4 uModel;\nuniform mat4 uView;\n\nvarying vec4 Position;\n\nvoid main() {\n    gl_Position = uPerspective * mat4(mat3(uView)) * uModel * aPosition;\n\n    Position = uModel * aPosition;\n}",w="\nprecision mediump float;\n\nvarying vec4 Position;\n\nuniform samplerCube uTexture;\n\nvoid main() {\n    vec4 col = vec4(textureCube(uTexture, Position.xyz).rgb * 0.55, 1.0);\n\tgl_FragColor = col;\n}";var D;function I(){(D=x(ue,S,w)).aPosition=ue.getAttribLocation(D,"aPosition"),D.uPerspective=ue.getUniformLocation(D,"uPerspective"),D.uModel=ue.getUniformLocation(D,"uModel"),D.uView=ue.getUniformLocation(D,"uView"),D.uTexture=ue.getUniformLocation(D,"uTexture"),D.texture=function(){var t=ue.createTexture();ue.bindTexture(ue.TEXTURE_CUBE_MAP,t),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_WRAP_S,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_WRAP_T,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_MIN_FILTER,ue.LINEAR),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_MAG_FILTER,ue.LINEAR);for(var e=[["./assets/images/skybox/posx.jpg",ue.TEXTURE_CUBE_MAP_POSITIVE_X],["./assets/images/skybox/negx.jpg",ue.TEXTURE_CUBE_MAP_NEGATIVE_X],["./assets/images/skybox/posy.jpg",ue.TEXTURE_CUBE_MAP_POSITIVE_Y],["./assets/images/skybox/negy.jpg",ue.TEXTURE_CUBE_MAP_NEGATIVE_Y],["./assets/images/skybox/posz.jpg",ue.TEXTURE_CUBE_MAP_POSITIVE_Z],["./assets/images/skybox/negz.jpg",ue.TEXTURE_CUBE_MAP_NEGATIVE_Z]],n=0;n<e.length;n++){var o=e[n][1],i=new Image;i.onload=function(t,e,n){return function(){ue.bindTexture(ue.TEXTURE_CUBE_MAP,t),ue.pixelStorei(ue.UNPACK_FLIP_Y_WEBGL,!1),ue.texImage2D(e,0,ue.RGBA,ue.RGBA,ue.UNSIGNED_BYTE,n)}}(t,o,i),i.src=e[n][0]}return t}();D.vertexBuffer=ue.createBuffer(),ue.bindBuffer(ue.ARRAY_BUFFER,D.vertexBuffer),ue.bufferData(ue.ARRAY_BUFFER,new Float32Array([-1,1,-1,1,-1,-1,-1,1,1,-1,-1,1,1,-1,-1,1,1,1,-1,1,-1,1,-1,1,-1,-1,1,1,-1,-1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,1,1,-1,-1,1,1,1,-1,-1,1,1,-1,1,1,1,1,1,1,1,1,1,1,1,1,-1,1,1,-1,-1,1,-1,-1,1,1,-1,1,1,1,1,1,1,1,1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,-1,1,1,1,-1,1,1,1,1,1,1,1,1,1,-1,1,1,1,-1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,-1,-1,1,1,-1,-1,1,-1,-1,1,1,1,-1,1,1]),ue.STATIC_DRAW)}const E="\nattribute vec4 aPosition;\n\nuniform mat4 uPerspective;\nuniform mat4 uModel;\nuniform mat4 uView;\n\nvoid main() {\n    gl_Position = uPerspective * uView * uModel * aPosition;\n}",A="\nprecision mediump float;\n\nvoid main() {\n\tgl_FragColor = vec4(1.0);\n}";var F=n(1);function z(t,e){var n=t.__state.conversionName.toString(),o=Math.round(t.r),i=Math.round(t.g),r=Math.round(t.b),a=t.a,s=Math.round(t.h),l=t.s.toFixed(1),u=t.v.toFixed(1);if(e||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var c=t.hex.toString(16);c.length<6;)c="0"+c;return"#"+c}return"CSS_RGB"===n?"rgb("+o+","+i+","+r+")":"CSS_RGBA"===n?"rgba("+o+","+i+","+r+","+a+")":"HEX"===n?"0x"+t.hex.toString(16):"RGB_ARRAY"===n?"["+o+","+i+","+r+"]":"RGBA_ARRAY"===n?"["+o+","+i+","+r+","+a+"]":"RGB_OBJ"===n?"{r:"+o+",g:"+i+",b:"+r+"}":"RGBA_OBJ"===n?"{r:"+o+",g:"+i+",b:"+r+",a:"+a+"}":"HSV_OBJ"===n?"{h:"+s+",s:"+l+",v:"+u+"}":"HSVA_OBJ"===n?"{h:"+s+",s:"+l+",v:"+u+",a:"+a+"}":"unknown format"}var P=Array.prototype.forEach,R=Array.prototype.slice,T={BREAK:{},extend:function(t){return this.each(R.call(arguments,1),function(e){(this.isObject(e)?Object.keys(e):[]).forEach(function(n){this.isUndefined(e[n])||(t[n]=e[n])}.bind(this))},this),t},defaults:function(t){return this.each(R.call(arguments,1),function(e){(this.isObject(e)?Object.keys(e):[]).forEach(function(n){this.isUndefined(t[n])&&(t[n]=e[n])}.bind(this))},this),t},compose:function(){var t=R.call(arguments);return function(){for(var e=R.call(arguments),n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},each:function(t,e,n){if(t)if(P&&t.forEach&&t.forEach===P)t.forEach(e,n);else if(t.length===t.length+0){var o,i=void 0;for(i=0,o=t.length;i<o;i++)if(i in t&&e.call(n,t[i],i)===this.BREAK)return}else for(var r in t)if(e.call(n,t[r],r)===this.BREAK)return},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var o=void 0;return function(){var i=this,r=arguments;var a=n||!o;clearTimeout(o),o=setTimeout(function(){o=null,n||t.apply(i,r)},e),a&&t.apply(i,r)}},toArray:function(t){return t.toArray?t.toArray():R.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return isNaN(t)}),isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return!1===t||!0===t},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}},C=[{litmus:T.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString(),0)}},write:z},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString(),0)}},write:z},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:z},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:z}}},{litmus:T.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:T.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:T.isObject,conversions:{RGBA_OBJ:{read:function(t){return!!(T.isNumber(t.r)&&T.isNumber(t.g)&&T.isNumber(t.b)&&T.isNumber(t.a))&&{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return!!(T.isNumber(t.r)&&T.isNumber(t.g)&&T.isNumber(t.b))&&{space:"RGB",r:t.r,g:t.g,b:t.b}},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return!!(T.isNumber(t.h)&&T.isNumber(t.s)&&T.isNumber(t.v)&&T.isNumber(t.a))&&{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return!!(T.isNumber(t.h)&&T.isNumber(t.s)&&T.isNumber(t.v))&&{space:"HSV",h:t.h,s:t.s,v:t.v}},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}],L=void 0,k=void 0,V=function(){k=!1;var t=arguments.length>1?T.toArray(arguments):arguments[0];return T.each(C,function(e){if(e.litmus(t))return T.each(e.conversions,function(e,n){if(L=e.read(t),!1===k&&!1!==L)return k=L,L.conversionName=n,L.conversion=e,T.BREAK}),T.BREAK}),k},O=void 0,B={hsv_to_rgb:function(t,e,n){var o=Math.floor(t/60)%6,i=t/60-Math.floor(t/60),r=n*(1-e),a=n*(1-i*e),s=n*(1-(1-i)*e),l=[[n,s,r],[a,n,r],[r,n,s],[r,a,n],[s,r,n],[n,r,a]][o];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(t,e,n){var o=Math.min(t,e,n),i=Math.max(t,e,n),r=i-o,a=void 0;return 0===i?{h:NaN,s:0,v:0}:(a=t===i?(e-n)/r:e===i?2+(n-t)/r:4+(t-e)/r,(a/=6)<0&&(a+=1),{h:360*a,s:r/i,v:i/255})},rgb_to_hex:function(t,e,n){var o=this.hex_with_component(0,2,t);return o=this.hex_with_component(o,1,e),o=this.hex_with_component(o,0,n)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(t,e,n){return n<<(O=8*e)|t&~(255<<O)}},U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},H=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),Y=function t(e,n,o){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:t(r,n,o)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(o):void 0},X=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},j=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},G=function(){function t(){if(N(this,t),this.__state=V.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return H(t,[{key:"toString",value:function(){return z(this)}},{key:"toHexString",value:function(){return z(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),t}();function q(t,e,n){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(G.recalculateRGB(this,e,n),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(G.recalculateRGB(this,e,n),this.__state.space="RGB"),this.__state[e]=t}})}function K(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(G.recalculateHSV(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(G.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=t}})}G.recalculateRGB=function(t,e,n){if("HEX"===t.__state.space)t.__state[e]=B.component_from_hex(t.__state.hex,n);else{if("HSV"!==t.__state.space)throw new Error("Corrupted color state");T.extend(t.__state,B.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}},G.recalculateHSV=function(t){var e=B.rgb_to_hsv(t.r,t.g,t.b);T.extend(t.__state,{s:e.s,v:e.v}),T.isNaN(e.h)?T.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=e.h},G.COMPONENTS=["r","g","b","h","s","v","hex","a"],q(G.prototype,"r",2),q(G.prototype,"g",1),q(G.prototype,"b",0),K(G.prototype,"h"),K(G.prototype,"s"),K(G.prototype,"v"),Object.defineProperty(G.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(G.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=B.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}});var W=function(){function t(e,n){N(this,t),this.initialValue=e[n],this.domElement=document.createElement("div"),this.object=e,this.property=n,this.__onChange=void 0,this.__onFinishChange=void 0}return H(t,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),t}(),Z={};T.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(t,e){T.each(t,function(t){Z[t]=e})});var J=/(\d+(\.\d+)?)px/;function Q(t){if("0"===t||T.isUndefined(t))return 0;var e=t.match(J);return T.isNull(e)?0:parseFloat(e[1])}var $={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(t,e,n){var o=n,i=e;T.isUndefined(i)&&(i=!0),T.isUndefined(o)&&(o=!0),t.style.position="absolute",i&&(t.style.left=0,t.style.right=0),o&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(t,e,n,o){var i=n||{},r=Z[e];if(!r)throw new Error("Event type "+e+" not supported.");var a=document.createEvent(r);switch(r){case"MouseEvents":var s=i.x||i.clientX||0,l=i.y||i.clientY||0;a.initMouseEvent(e,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,s,l,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var u=a.initKeyboardEvent||a.initKeyEvent;T.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),u(e,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:a.initEvent(e,i.bubbles||!1,i.cancelable||!0)}T.defaults(a,o),t.dispatchEvent(a)},bind:function(t,e,n,o){var i=o||!1;return t.addEventListener?t.addEventListener(e,n,i):t.attachEvent&&t.attachEvent("on"+e,n),$},unbind:function(t,e,n,o){var i=o||!1;return t.removeEventListener?t.removeEventListener(e,n,i):t.detachEvent&&t.detachEvent("on"+e,n),$},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var n=t.className.split(/ +/);-1===n.indexOf(e)&&(n.push(e),t.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return $},removeClass:function(t,e){if(e)if(t.className===e)t.removeAttribute("class");else{var n=t.className.split(/ +/),o=n.indexOf(e);-1!==o&&(n.splice(o,1),t.className=n.join(" "))}else t.className=void 0;return $},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var e=getComputedStyle(t);return Q(e["border-left-width"])+Q(e["border-right-width"])+Q(e["padding-left"])+Q(e["padding-right"])+Q(e.width)},getHeight:function(t){var e=getComputedStyle(t);return Q(e["border-top-width"])+Q(e["border-bottom-width"])+Q(e["padding-top"])+Q(e["padding-bottom"])+Q(e.height)},getOffset:function(t){var e=t,n={left:0,top:0};if(e.offsetParent)do{n.left+=e.offsetLeft,n.top+=e.offsetTop,e=e.offsetParent}while(e);return n},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}},tt=function(t){function e(t,n){N(this,e);var o=j(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),i=o;return o.__prev=o.getValue(),o.__checkbox=document.createElement("input"),o.__checkbox.setAttribute("type","checkbox"),$.bind(o.__checkbox,"change",function(){i.setValue(!i.__prev)},!1),o.domElement.appendChild(o.__checkbox),o.updateDisplay(),o}return X(e,W),H(e,[{key:"setValue",value:function(t){var n=Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(),et=function(t){function e(t,n,o){N(this,e);var i=j(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),r=o,a=i;if(i.__select=document.createElement("select"),T.isArray(r)){var s={};T.each(r,function(t){s[t]=t}),r=s}return T.each(r,function(t,e){var n=document.createElement("option");n.innerHTML=e,n.setAttribute("value",t),a.__select.appendChild(n)}),i.updateDisplay(),$.bind(i.__select,"change",function(){var t=this.options[this.selectedIndex].value;a.setValue(t)}),i.domElement.appendChild(i.__select),i}return X(e,W),H(e,[{key:"setValue",value:function(t){var n=Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n}},{key:"updateDisplay",value:function(){return $.isActive(this.__select)?this:(this.__select.value=this.getValue(),Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(),nt=function(t){function e(t,n){N(this,e);var o=j(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),i=o;function r(){i.setValue(i.__input.value)}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),$.bind(o.__input,"keyup",r),$.bind(o.__input,"change",r),$.bind(o.__input,"blur",function(){i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())}),$.bind(o.__input,"keydown",function(t){13===t.keyCode&&this.blur()}),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return X(e,W),H(e,[{key:"updateDisplay",value:function(){return $.isActive(this.__input)||(this.__input.value=this.getValue()),Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}();function ot(t){var e=t.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var it=function(t){function e(t,n,o){N(this,e);var i=j(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),r=o||{};return i.__min=r.min,i.__max=r.max,i.__step=r.step,T.isUndefined(i.__step)?0===i.initialValue?i.__impliedStep=1:i.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(i.initialValue))/Math.LN10))/10:i.__impliedStep=i.__step,i.__precision=ot(i.__impliedStep),i}return X(e,W),H(e,[{key:"setValue",value:function(t){var n=t;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,n)}},{key:"min",value:function(t){return this.__min=t,this}},{key:"max",value:function(t){return this.__max=t,this}},{key:"step",value:function(t){return this.__step=t,this.__impliedStep=t,this.__precision=ot(t),this}}]),e}();var rt=function(t){function e(t,n,o){N(this,e);var i=j(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o));i.__truncationSuspended=!1;var r=i,a=void 0;function s(){r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}function l(t){var e=a-t.clientY;r.setValue(r.getValue()+e*r.__impliedStep),a=t.clientY}function u(){$.unbind(window,"mousemove",l),$.unbind(window,"mouseup",u),s()}return i.__input=document.createElement("input"),i.__input.setAttribute("type","text"),$.bind(i.__input,"change",function(){var t=parseFloat(r.__input.value);T.isNaN(t)||r.setValue(t)}),$.bind(i.__input,"blur",function(){s()}),$.bind(i.__input,"mousedown",function(t){$.bind(window,"mousemove",l),$.bind(window,"mouseup",u),a=t.clientY}),$.bind(i.__input,"keydown",function(t){13===t.keyCode&&(r.__truncationSuspended=!0,this.blur(),r.__truncationSuspended=!1,s())}),i.updateDisplay(),i.domElement.appendChild(i.__input),i}return X(e,it),H(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():function(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}(this.getValue(),this.__precision),Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}();function at(t,e,n,o,i){return o+(t-e)/(n-e)*(i-o)}var st=function(t){function e(t,n,o,i,r){N(this,e);var a=j(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{min:o,max:i,step:r})),s=a;function l(t){t.preventDefault();var e=s.__background.getBoundingClientRect();return s.setValue(at(t.clientX,e.left,e.right,s.__min,s.__max)),!1}function u(){$.unbind(window,"mousemove",l),$.unbind(window,"mouseup",u),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function c(t){var e=t.touches[0].clientX,n=s.__background.getBoundingClientRect();s.setValue(at(e,n.left,n.right,s.__min,s.__max))}function d(){$.unbind(window,"touchmove",c),$.unbind(window,"touchend",d),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}return a.__background=document.createElement("div"),a.__foreground=document.createElement("div"),$.bind(a.__background,"mousedown",function(t){document.activeElement.blur(),$.bind(window,"mousemove",l),$.bind(window,"mouseup",u),l(t)}),$.bind(a.__background,"touchstart",function(t){if(1!==t.touches.length)return;$.bind(window,"touchmove",c),$.bind(window,"touchend",d),c(t)}),$.addClass(a.__background,"slider"),$.addClass(a.__foreground,"slider-fg"),a.updateDisplay(),a.__background.appendChild(a.__foreground),a.domElement.appendChild(a.__background),a}return X(e,it),H(e,[{key:"updateDisplay",value:function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*t+"%",Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(),lt=function(t){function e(t,n,o){N(this,e);var i=j(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),r=i;return i.__button=document.createElement("div"),i.__button.innerHTML=void 0===o?"Fire":o,$.bind(i.__button,"click",function(t){return t.preventDefault(),r.fire(),!1}),$.addClass(i.__button,"button"),i.domElement.appendChild(i.__button),i}return X(e,W),H(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(),ut=function(t){function e(t,n){N(this,e);var o=j(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));o.__color=new G(o.getValue()),o.__temp=new G(0);var i=o;o.domElement=document.createElement("div"),$.makeSelectable(o.domElement,!1),o.__selector=document.createElement("div"),o.__selector.className="selector",o.__saturation_field=document.createElement("div"),o.__saturation_field.className="saturation-field",o.__field_knob=document.createElement("div"),o.__field_knob.className="field-knob",o.__field_knob_border="2px solid ",o.__hue_knob=document.createElement("div"),o.__hue_knob.className="hue-knob",o.__hue_field=document.createElement("div"),o.__hue_field.className="hue-field",o.__input=document.createElement("input"),o.__input.type="text",o.__input_textShadow="0 1px 1px ",$.bind(o.__input,"keydown",function(t){13===t.keyCode&&c.call(this)}),$.bind(o.__input,"blur",c),$.bind(o.__selector,"mousedown",function(){$.addClass(this,"drag").bind(window,"mouseup",function(){$.removeClass(i.__selector,"drag")})}),$.bind(o.__selector,"touchstart",function(){$.addClass(this,"drag").bind(window,"touchend",function(){$.removeClass(i.__selector,"drag")})});var r=document.createElement("div");function a(t){h(t),$.bind(window,"mousemove",h),$.bind(window,"touchmove",h),$.bind(window,"mouseup",l),$.bind(window,"touchend",l)}function s(t){f(t),$.bind(window,"mousemove",f),$.bind(window,"touchmove",f),$.bind(window,"mouseup",u),$.bind(window,"touchend",u)}function l(){$.unbind(window,"mousemove",h),$.unbind(window,"touchmove",h),$.unbind(window,"mouseup",l),$.unbind(window,"touchend",l),d()}function u(){$.unbind(window,"mousemove",f),$.unbind(window,"touchmove",f),$.unbind(window,"mouseup",u),$.unbind(window,"touchend",u),d()}function c(){var t=V(this.value);!1!==t?(i.__color.__state=t,i.setValue(i.__color.toOriginal())):this.value=i.__color.toString()}function d(){i.__onFinishChange&&i.__onFinishChange.call(i,i.__color.toOriginal())}function h(t){-1===t.type.indexOf("touch")&&t.preventDefault();var e=i.__saturation_field.getBoundingClientRect(),n=t.touches&&t.touches[0]||t,o=n.clientX,r=n.clientY,a=(o-e.left)/(e.right-e.left),s=1-(r-e.top)/(e.bottom-e.top);return s>1?s=1:s<0&&(s=0),a>1?a=1:a<0&&(a=0),i.__color.v=s,i.__color.s=a,i.setValue(i.__color.toOriginal()),!1}function f(t){-1===t.type.indexOf("touch")&&t.preventDefault();var e=i.__hue_field.getBoundingClientRect(),n=1-((t.touches&&t.touches[0]||t).clientY-e.top)/(e.bottom-e.top);return n>1?n=1:n<0&&(n=0),i.__color.h=360*n,i.setValue(i.__color.toOriginal()),!1}return T.extend(o.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),T.extend(o.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:o.__field_knob_border+(o.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),T.extend(o.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),T.extend(o.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),T.extend(r.style,{width:"100%",height:"100%",background:"none"}),dt(r,"top","rgba(0,0,0,0)","#000"),T.extend(o.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),function(t){t.style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}(o.__hue_field),T.extend(o.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:o.__input_textShadow+"rgba(0,0,0,0.7)"}),$.bind(o.__saturation_field,"mousedown",a),$.bind(o.__saturation_field,"touchstart",a),$.bind(o.__field_knob,"mousedown",a),$.bind(o.__field_knob,"touchstart",a),$.bind(o.__hue_field,"mousedown",s),$.bind(o.__hue_field,"touchstart",s),o.__saturation_field.appendChild(r),o.__selector.appendChild(o.__field_knob),o.__selector.appendChild(o.__saturation_field),o.__selector.appendChild(o.__hue_field),o.__hue_field.appendChild(o.__hue_knob),o.domElement.appendChild(o.__input),o.domElement.appendChild(o.__selector),o.updateDisplay(),o}return X(e,W),H(e,[{key:"updateDisplay",value:function(){var t=V(this.getValue());if(!1!==t){var e=!1;T.each(G.COMPONENTS,function(n){if(!T.isUndefined(t[n])&&!T.isUndefined(this.__color.__state[n])&&t[n]!==this.__color.__state[n])return e=!0,{}},this),e&&T.extend(this.__color.__state,t)}T.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,o=255-n;T.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,dt(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),T.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),e}(),ct=["-moz-","-o-","-webkit-","-ms-",""];function dt(t,e,n,o){t.style.background="",T.each(ct,function(i){t.style.cssText+="background: "+i+"linear-gradient("+e+", "+n+" 0%, "+o+" 100%); "})}var ht=function(t,e){var n=e||document,o=document.createElement("style");o.type="text/css",o.innerHTML=t;var i=n.getElementsByTagName("head")[0];try{i.appendChild(o)}catch(t){}},ft=function(t,e){var n=t[e];return T.isArray(arguments[2])||T.isObject(arguments[2])?new et(t,e,arguments[2]):T.isNumber(n)?T.isNumber(arguments[2])&&T.isNumber(arguments[3])?T.isNumber(arguments[4])?new st(t,e,arguments[2],arguments[3],arguments[4]):new st(t,e,arguments[2],arguments[3]):T.isNumber(arguments[4])?new rt(t,e,{min:arguments[2],max:arguments[3],step:arguments[4]}):new rt(t,e,{min:arguments[2],max:arguments[3]}):T.isString(n)?new nt(t,e):T.isFunction(n)?new lt(t,e,""):T.isBoolean(n)?new tt(t,e):null};var mt=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,1e3/60)},pt=function(){function t(){N(this,t),this.backgroundElement=document.createElement("div"),T.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),$.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),T.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;$.bind(this.backgroundElement,"click",function(){e.hide()})}return H(t,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),T.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,e=function e(){t.domElement.style.display="none",t.backgroundElement.style.display="none",$.unbind(t.domElement,"webkitTransitionEnd",e),$.unbind(t.domElement,"transitionend",e),$.unbind(t.domElement,"oTransitionEnd",e)};$.bind(this.domElement,"webkitTransitionEnd",e),$.bind(this.domElement,"transitionend",e),$.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-$.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-$.getHeight(this.domElement)/2+"px"}}]),t}();ht(function(t){if(t&&"undefined"!=typeof window){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=t,document.head.appendChild(e),t}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var _t="Default",xt=function(){try{return!!window.localStorage}catch(t){return!1}}(),vt=void 0,gt=!0,bt=void 0,Mt=!1,yt=[],St=function t(e){var n=this,o=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),$.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],o=T.defaults(o,{closeOnTop:!1,autoPlace:!0,width:t.DEFAULT_WIDTH}),o=T.defaults(o,{resizable:o.autoPlace,hideable:o.autoPlace}),T.isUndefined(o.load)?o.load={preset:_t}:o.preset&&(o.load.preset=o.preset),T.isUndefined(o.parent)&&o.hideable&&yt.push(this),o.resizable=T.isUndefined(o.parent)&&o.resizable,o.autoPlace&&T.isUndefined(o.scrollable)&&(o.scrollable=!0);var i=xt&&"true"===localStorage.getItem(Ft(this,"isLocal")),r=void 0;if(Object.defineProperties(this,{parent:{get:function(){return o.parent}},scrollable:{get:function(){return o.scrollable}},autoPlace:{get:function(){return o.autoPlace}},closeOnTop:{get:function(){return o.closeOnTop}},preset:{get:function(){return n.parent?n.getRoot().preset:o.load.preset},set:function(t){n.parent?n.getRoot().preset=t:o.load.preset=t,function(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value===t.preset&&(t.__preset_select.selectedIndex=e)}(this),n.revert()}},width:{get:function(){return o.width},set:function(t){o.width=t,Tt(n,t)}},name:{get:function(){return o.name},set:function(t){o.name=t,titleRowName&&(titleRowName.innerHTML=o.name)}},closed:{get:function(){return o.closed},set:function(e){o.closed=e,o.closed?$.addClass(n.__ul,t.CLASS_CLOSED):$.removeClass(n.__ul,t.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=e?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return o.load}},useLocalStorage:{get:function(){return i},set:function(t){xt&&(i=t,t?$.bind(window,"unload",r):$.unbind(window,"unload",r),localStorage.setItem(Ft(n,"isLocal"),t))}}}),T.isUndefined(o.parent)){if(o.closed=!1,$.addClass(this.domElement,t.CLASS_MAIN),$.makeSelectable(this.domElement,!1),xt&&i){n.useLocalStorage=!0;var a=localStorage.getItem(Ft(this,"gui"));a&&(o.load=JSON.parse(a))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=t.TEXT_CLOSED,$.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON),o.closeOnTop?($.addClass(this.__closeButton,t.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):($.addClass(this.__closeButton,t.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),$.bind(this.__closeButton,"click",function(){n.closed=!n.closed})}else{void 0===o.closed&&(o.closed=!0);var s=document.createTextNode(o.name);$.addClass(s,"controller-name");var l=wt(n,s);$.addClass(this.__ul,t.CLASS_CLOSED),$.addClass(l,"title"),$.bind(l,"click",function(t){return t.preventDefault(),n.closed=!n.closed,!1}),o.closed||(this.closed=!1)}o.autoPlace&&(T.isUndefined(o.parent)&&(gt&&(bt=document.createElement("div"),$.addClass(bt,"dg"),$.addClass(bt,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(bt),gt=!1),bt.appendChild(this.domElement),$.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||Tt(n,o.width)),this.__resizeHandler=function(){n.onResizeDebounced()},$.bind(window,"resize",this.__resizeHandler),$.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),$.bind(this.__ul,"transitionend",this.__resizeHandler),$.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),o.resizable&&Rt(this),r=function(){xt&&"true"===localStorage.getItem(Ft(n,"isLocal"))&&localStorage.setItem(Ft(n,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=r,o.parent||function(){var t=n.getRoot();t.width+=1,T.defer(function(){t.width-=1})}()};function wt(t,e,n){var o=document.createElement("li");return e&&o.appendChild(e),n?t.__ul.insertBefore(o,n):t.__ul.appendChild(o),t.onResize(),o}function Dt(t){$.unbind(window,"resize",t.__resizeHandler),t.saveToLocalStorageIfPossible&&$.unbind(window,"unload",t.saveToLocalStorageIfPossible)}function It(t,e){var n=t.__preset_select[t.__preset_select.selectedIndex];n.innerHTML=e?n.value+"*":n.value}function Et(t,e){var n=t.getRoot(),o=n.__rememberedObjects.indexOf(e.object);if(-1!==o){var i=n.__rememberedObjectIndecesToControllers[o];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[o]=i),i[e.property]=e,n.load&&n.load.remembered){var r=n.load.remembered,a=void 0;if(r[t.preset])a=r[t.preset];else{if(!r[_t])return;a=r[_t]}if(a[o]&&void 0!==a[o][e.property]){var s=a[o][e.property];e.initialValue=s,e.setValue(s)}}}}function At(t,e,n,o){if(void 0===e[n])throw new Error('Object "'+e+'" has no property "'+n+'"');var i=void 0;if(o.color)i=new ut(e,n);else{var r=[e,n].concat(o.factoryArgs);i=ft.apply(t,r)}o.before instanceof W&&(o.before=o.before.__li),Et(t,i),$.addClass(i.domElement,"c");var a=document.createElement("span");$.addClass(a,"property-name"),a.innerHTML=i.property;var s=document.createElement("div");s.appendChild(a),s.appendChild(i.domElement);var l=wt(t,s,o.before);return $.addClass(l,St.CLASS_CONTROLLER_ROW),i instanceof ut?$.addClass(l,"color"):$.addClass(l,U(i.getValue())),function(t,e,n){if(n.__li=e,n.__gui=t,T.extend(n,{options:function(e){if(arguments.length>1){var o=n.__li.nextElementSibling;return n.remove(),At(t,n.object,n.property,{before:o,factoryArgs:[T.toArray(arguments)]})}if(T.isArray(e)||T.isObject(e)){var i=n.__li.nextElementSibling;return n.remove(),At(t,n.object,n.property,{before:i,factoryArgs:[e]})}},name:function(t){return n.__li.firstElementChild.firstElementChild.innerHTML=t,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof st){var o=new rt(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});T.each(["updateDisplay","onChange","onFinishChange","step"],function(t){var e=n[t],i=o[t];n[t]=o[t]=function(){var t=Array.prototype.slice.call(arguments);return i.apply(o,t),e.apply(n,t)}}),$.addClass(e,"has-slider"),n.domElement.insertBefore(o.domElement,n.domElement.firstElementChild)}else if(n instanceof rt){var i=function(e){if(T.isNumber(n.__min)&&T.isNumber(n.__max)){var o=n.__li.firstElementChild.firstElementChild.innerHTML,i=n.__gui.__listening.indexOf(n)>-1;n.remove();var r=At(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return r.name(o),i&&r.listen(),r}return e};n.min=T.compose(i,n.min),n.max=T.compose(i,n.max)}else n instanceof tt?($.bind(e,"click",function(){$.fakeEvent(n.__checkbox,"click")}),$.bind(n.__checkbox,"click",function(t){t.stopPropagation()})):n instanceof lt?($.bind(e,"click",function(){$.fakeEvent(n.__button,"click")}),$.bind(e,"mouseover",function(){$.addClass(n.__button,"hover")}),$.bind(e,"mouseout",function(){$.removeClass(n.__button,"hover")})):n instanceof ut&&($.addClass(e,"color"),n.updateDisplay=T.compose(function(t){return e.style.borderLeftColor=n.__color.toString(),t},n.updateDisplay),n.updateDisplay());n.setValue=T.compose(function(e){return t.getRoot().__preset_select&&n.isModified()&&It(t.getRoot(),!0),e},n.setValue)}(t,l,i),t.__controllers.push(i),i}function Ft(t,e){return document.location.href+"."+e}function zt(t,e,n){var o=document.createElement("option");o.innerHTML=e,o.value=e,t.__preset_select.appendChild(o),n&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function Pt(t,e){e.style.display=t.useLocalStorage?"block":"none"}function Rt(t){var e=void 0;function n(n){return n.preventDefault(),t.width+=e-n.clientX,t.onResize(),e=n.clientX,!1}function o(){$.removeClass(t.__closeButton,St.CLASS_DRAG),$.unbind(window,"mousemove",n),$.unbind(window,"mouseup",o)}function i(i){return i.preventDefault(),e=i.clientX,$.addClass(t.__closeButton,St.CLASS_DRAG),$.bind(window,"mousemove",n),$.bind(window,"mouseup",o),!1}t.__resize_handle=document.createElement("div"),T.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),$.bind(t.__resize_handle,"mousedown",i),$.bind(t.__closeButton,"mousedown",i),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function Tt(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function Ct(t,e){var n={};return T.each(t.__rememberedObjects,function(o,i){var r={},a=t.__rememberedObjectIndecesToControllers[i];T.each(a,function(t,n){r[n]=e?t.initialValue:t.getValue()}),n[i]=r}),n}St.toggleHide=function(){Mt=!Mt,T.each(yt,function(t){t.domElement.style.display=Mt?"none":""})},St.CLASS_AUTO_PLACE="a",St.CLASS_AUTO_PLACE_CONTAINER="ac",St.CLASS_MAIN="main",St.CLASS_CONTROLLER_ROW="cr",St.CLASS_TOO_TALL="taller-than-window",St.CLASS_CLOSED="closed",St.CLASS_CLOSE_BUTTON="close-button",St.CLASS_CLOSE_TOP="close-top",St.CLASS_CLOSE_BOTTOM="close-bottom",St.CLASS_DRAG="drag",St.DEFAULT_WIDTH=245,St.TEXT_CLOSED="Close Controls",St.TEXT_OPEN="Open Controls",St._keydownHandler=function(t){"text"===document.activeElement.type||72!==t.which&&72!==t.keyCode||St.toggleHide()},$.bind(window,"keydown",St._keydownHandler,!1),T.extend(St.prototype,{add:function(t,e){return At(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return At(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.splice(this.__controllers.indexOf(t),1);var e=this;T.defer(function(){e.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&bt.removeChild(this.domElement);var t=this;T.each(this.__folders,function(e){t.removeFolder(e)}),$.unbind(window,"keydown",St._keydownHandler,!1),Dt(this)},addFolder:function(t){if(void 0!==this.__folders[t])throw new Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]);var n=new St(e);this.__folders[t]=n;var o=wt(this,n.domElement);return $.addClass(o,"folder"),n},removeFolder:function(t){this.__ul.removeChild(t.domElement.parentElement),delete this.__folders[t.name],this.load&&this.load.folders&&this.load.folders[t.name]&&delete this.load.folders[t.name],Dt(t);var e=this;T.each(t.__folders,function(e){t.removeFolder(e)}),T.defer(function(){e.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=$.getOffset(t.__ul).top,n=0;T.each(t.__ul.childNodes,function(e){t.autoPlace&&e===t.__save_row||(n+=$.getHeight(e))}),window.innerHeight-e-20<n?($.addClass(t.domElement,St.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-20+"px"):($.removeClass(t.domElement,St.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&T.defer(function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"}),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},onResizeDebounced:T.debounce(function(){this.onResize()},50),remember:function(){if(T.isUndefined(vt)&&((vt=new pt).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;T.each(Array.prototype.slice.call(arguments),function(e){0===t.__rememberedObjects.length&&function(t){var e=t.__save_row=document.createElement("li");$.addClass(t.domElement,"has-save"),t.__ul.insertBefore(e,t.__ul.firstChild),$.addClass(e,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",$.addClass(n,"button gears");var o=document.createElement("span");o.innerHTML="Save",$.addClass(o,"button"),$.addClass(o,"save");var i=document.createElement("span");i.innerHTML="New",$.addClass(i,"button"),$.addClass(i,"save-as");var r=document.createElement("span");r.innerHTML="Revert",$.addClass(r,"button"),$.addClass(r,"revert");var a=t.__preset_select=document.createElement("select");t.load&&t.load.remembered?T.each(t.load.remembered,function(e,n){zt(t,n,n===t.preset)}):zt(t,_t,!1);if($.bind(a,"change",function(){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].innerHTML=t.__preset_select[e].value;t.preset=this.value}),e.appendChild(a),e.appendChild(n),e.appendChild(o),e.appendChild(i),e.appendChild(r),xt){var s=document.getElementById("dg-local-explain"),l=document.getElementById("dg-local-storage"),u=document.getElementById("dg-save-locally");u.style.display="block","true"===localStorage.getItem(Ft(t,"isLocal"))&&l.setAttribute("checked","checked"),Pt(t,s),$.bind(l,"change",function(){t.useLocalStorage=!t.useLocalStorage,Pt(t,s)})}var c=document.getElementById("dg-new-constructor");$.bind(c,"keydown",function(t){!t.metaKey||67!==t.which&&67!==t.keyCode||vt.hide()}),$.bind(n,"click",function(){c.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),vt.show(),c.focus(),c.select()}),$.bind(o,"click",function(){t.save()}),$.bind(i,"click",function(){var e=prompt("Enter a new preset name.");e&&t.saveAs(e)}),$.bind(r,"click",function(){t.revert()})}(t),-1===t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&Tt(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=Ct(this)),t.folders={},T.each(this.__folders,function(e,n){t.folders[n]=e.getSaveObject()}),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=Ct(this),It(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered[_t]=Ct(this,!0)),this.load.remembered[t]=Ct(this),this.preset=t,zt(this,t,!0),this.saveToLocalStorageIfPossible()},revert:function(t){T.each(this.__controllers,function(e){this.getRoot().load.remembered?Et(t||this.getRoot(),e):e.setValue(e.initialValue),e.__onFinishChange&&e.__onFinishChange.call(e,e.getValue())},this),T.each(this.__folders,function(t){t.revert(t)}),t||It(this.getRoot(),!1)},listen:function(t){var e=0===this.__listening.length;this.__listening.push(t),e&&function t(e){0!==e.length&&mt.call(window,function(){t(e)});T.each(e,function(t){t.updateDisplay()})}(this.__listening)},updateDisplay:function(){T.each(this.__controllers,function(t){t.updateDisplay()}),T.each(this.__folders,function(t){t.updateDisplay()})}});const Lt=new St;var kt={raysPerCycle:1e3,lightSize:.4,lightStrenght:5,lightYaw:2.1,lightPitch:.61,lightDistance:3,IOR:1.5,dispersion:.03,resolution:550,skybox:!0,refractiveLightReflection:!0,reset:function(){kt.raysPerCycle=1e3,kt.lightSize=.4,kt.lightStrenght=5,kt.lightYaw=2.1,kt.lightPitch=.61,kt.lightDistance=3,kt.IOR=1.5,kt.dispersion=.03,kt.resolution=550,me.updateParams(kt)}};var Vt,Ot,Bt,Ut,Nt,Ht,Yt={x:-0,y:1,z:3},Xt={x:-0-Yt.x,y:0-Yt.y,z:-Yt.z},jt=1e3,Gt=550,qt=1.5,Kt=.033,Wt=1,Zt=1,Jt=1.5,Qt=!0,$t=0,te=i.vec3.fromValues(0,0,0),ee=i.vec3.fromValues(0,0,0),ne=i.vec3.fromValues(0,0,0),oe=7;function ie(){var t=Math.floor(3*Math.random()),e=Math.random(),n=Math.random(),o=2*Math.PI*e,r=Math.acos(Math.sqrt(n)),a=[te[0]*Math.cos(o)*Math.sin(r),te[1]*Math.cos(o)*Math.sin(r),te[2]*Math.cos(o)*Math.sin(r)],s=[ee[0]*Math.sin(o)*Math.sin(r),ee[1]*Math.sin(o)*Math.sin(r),ee[2]*Math.sin(o)*Math.sin(r)],l=[ne[0]*Math.cos(r),ne[1]*Math.cos(r),ne[2]*Math.cos(r)],u=i.vec3.fromValues(a[0]+s[0]+l[0],a[1]+s[1]+l[1],a[2]+s[2]+l[2]);if(!(i.vec3.dot(ne,u)<0)){i.vec3.normalize(u,u),Nt.x=u[0],Nt.y=u[1],Nt.z=u[2];var c=(2*Math.random()-1)*Wt,d=i.vec3.fromValues(te[0],te[1],te[2]);d[0]*=c,d[1]*=c,d[2]*=c;var h=(2*Math.random()-1)*Wt,f=i.vec3.fromValues(ee[0],ee[1],ee[2]);f[0]*=h,f[1]*=h,f[2]*=h,Ht.x=Yt.x+f[0]+d[0],Ht.y=Yt.y+f[1]+d[1],Ht.z=Yt.z+f[2]+d[2];for(var m=0;m<10;m++){var p=Ut.intersectRay(Ht,Nt,!1);if(0===p.length)return;var _=re(p);if(0===_.triangleIndex||1===_.triangleIndex){var x=Qt;0===m&&(x=!1);var v=_.intersectionPoint,g=(v.x+3)/6,b=(v.z+3)/6,M=Math.floor(g*Gt),y=Math.floor(b*Gt),S=3*Zt*Jt;if(x)switch(t){case 0:Bt[4*(y*Gt+M)+0]+=S;break;case 1:Bt[4*(y*Gt+M)+1]+=S;break;case 2:Bt[4*(y*Gt+M)+2]+=S}else Bt[4*(y*Gt+M)+0]+=1*Jt,Bt[4*(y*Gt+M)+1]+=1*Jt,Bt[4*(y*Gt+M)+2]+=1*Jt;return 0===m&&(x=Qt),void $t++}Ht.x=_.intersectionPoint.x+.01*Nt.x,Ht.y=_.intersectionPoint.y+.01*Nt.y,Ht.z=_.intersectionPoint.z+.01*Nt.z;var w=i.vec3.fromValues(Vt[_.triangleIndex][0],Vt[_.triangleIndex][1],Vt[_.triangleIndex][2]);_.backface&&(w[0]=-w[0],w[1]=-w[1],w[2]=-w[2]);var D=1/qt;switch(t){case 1:D=1/(qt+Kt);break;case 2:D=1/(qt+2*Kt)}Qt||(D=1/qt),ae(u,u,w,D),Nt.x=u[0],Nt.y=u[1],Nt.z=u[2]}}}function re(t){for(var e=-1,n=999,o=0;o<t.length;o++){var i=t[o].intersectionPoint,r=i.x-Ht.x,a=i.y-Ht.y,s=i.z-Ht.z,l=r*r+a*a+s*s;l<n&&(n=l,e=o)}return t[e]}function ae(t,e,n,o){var r=i.vec3.dot(n,e),a=1-o*o*(1-r*r),s=Math.sqrt(a);a<0?(t[0]=0,t[1]=0,t[2]=0):(t[0]=o*e[0]-(o*r+s)*n[0],t[1]=o*e[1]-(o*r+s)*n[1],t[2]=o*e[2]-(o*r+s)*n[2])}function se(){var t={x:Yt.x-te[0]*Wt-ee[0]*Wt,y:Yt.y-te[1]*Wt-ee[1]*Wt,z:Yt.z-te[2]*Wt-ee[2]*Wt},e={x:Yt.x+te[0]*Wt-ee[0]*Wt,y:Yt.y+te[1]*Wt-ee[1]*Wt,z:Yt.z+te[2]*Wt-ee[2]*Wt},n={x:Yt.x-te[0]*Wt+ee[0]*Wt,y:Yt.y-te[1]*Wt+ee[1]*Wt,z:Yt.z-te[2]*Wt+ee[2]*Wt},o={x:Yt.x+te[0]*Wt+ee[0]*Wt,y:Yt.y+te[1]*Wt+ee[1]*Wt,z:Yt.z+te[2]*Wt+ee[2]*Wt};return[t.x,t.y,t.z,1,e.x,e.y,e.z,1,n.x,n.y,n.z,1,n.x,n.y,n.z,1,e.x,e.y,e.z,1,o.x,o.y,o.z,1]}function le(t){!function(t){Wt=t.lightSize;var e=t.lightYaw,n=t.lightPitch,o=t.lightDistance,r=Math.cos(e)*Math.cos(n)*o,a=Math.sin(n)*o,s=Math.sin(e)*Math.cos(n)*o;Xt={x:-0-(Yt={x:r,y:a,z:s}).x,y:0-Yt.y,z:-Yt.z},ne=i.vec3.fromValues(Xt.x,Xt.y,Xt.z),i.vec3.normalize(ne,ne),i.vec3.cross(te,ne,i.vec3.fromValues(0,1,0)),i.vec3.normalize(te,te),i.vec3.cross(ee,ne,te),i.vec3.normalize(ee,ee),Jt=t.lightStrenght,Kt=t.dispersion,qt=t.IOR,Qt=0!==Kt}(t),$t=0,Bt=new Float32Array(Gt*Gt*4),ye.vertexBuffer=ue.createBuffer(),ue.bindBuffer(ue.ARRAY_BUFFER,ye.vertexBuffer),ue.bufferData(ue.ARRAY_BUFFER,new Float32Array(se()),ue.STATIC_DRAW)}var ue,ce,de,he,fe,me={updateParams:le,updateRaycount:function(){jt=kt.raysPerCycle},updateResolution:function(){Gt=Math.floor(kt.resolution),Bt=new Float32Array(Gt*Gt*4),$t=0}};n.d(e,"gl",function(){return ue}),n.d(e,"perspective",function(){return _e}),n.d(e,"model",function(){return xe}),n.d(e,"view",function(){return ve}),n.d(e,"PlaneProgram",function(){return he}),n.d(e,"LightPlaneProgram",function(){return ye});var pe,_e,xe,ve,ge=Float32Array.BYTES_PER_ELEMENT,be=[],Me=[];!function(){(ce=document.getElementById("canvas")).width=innerWidth,ce.height=innerHeight;var t=["webgl","experimental-webgl"];for(var e in t)try{if((ue=ce.getContext(t[e],{}))&&"function"==typeof ue.getParameter)break}catch(t){}null===ue&&alert("could not initialize WebGL"),ue.getExtension("OES_texture_float"),ue.getExtension("OES_texture_float_linear")}(),(de=new function(){this.getViewMatrix=s,this.params=a,this.camera_keydown=l,this.camera_keyup=u,this.camera_mousemove=c,this.camera_mousedown=h,this.camera_mouseup=f,this.camera_zoom=_,this.camera_touchdown=m,this.camera_touchup=p,this.camera_touchmove=d,this.pos=i.vec3.fromValues(0,0,0),this.up=i.vec3.fromValues(0,1,0),this.front=i.vec3.fromValues(0,0,-1),this.frontCross=i.vec3.fromValues(0,0,0),this.dir=i.vec3.fromValues(0,0,0),this.speed=5,this.zoom_smoothness=.1,this.autoCentered=!1,this.autoRotate=!1,this.autoRotateSpeed=3,this.radius=3,this.look=[0,0,0],this.mousecontrols=!0,this.depth_of_field_transform_count=0,this.lookAt=i.mat4.create(),this.yaw=-1.57,this.pitch=0,this.deltaRot=[0,0],this.lastPos=[null,null],this.deltazoom=0,this.dragging=!1,this.startingZoom=window.zoom,this.zoomdefined=!1,this.smoothDeltaTimeCheck=!0,this.rotationSensitivity=.002,this.pressedKeys={w:!1,s:!1,a:!1,d:!1,space:!1,shift:!1,la:!1,ua:!1,ra:!1,da:!1},this.mousecontrols&&(window.addEventListener("keydown",this.camera_keydown.bind(this)),window.addEventListener("keyup",this.camera_keyup.bind(this)),document.getElementById("canvas").addEventListener("mousemove",this.camera_mousemove.bind(this)),document.getElementById("canvas").addEventListener("mousedown",this.camera_mousedown.bind(this)),window.addEventListener("mouseup",this.camera_mouseup.bind(this)),document.getElementById("canvas").addEventListener("touchstart",this.camera_touchdown.bind(this)),document.getElementById("canvas").addEventListener("touchmove",this.camera_touchmove.bind(this)),window.addEventListener("touchend",this.camera_touchup.bind(this)),window.addEventListener("DOMMouseScroll",this.camera_zoom.bind(this)))}).pos=[0,3,10],de.look=[0,.1,0],de.autoCentered=!0,de.radius=6,de.yaw=.9,de.pitch=.5,_e=i.mat4.create(),xe=i.mat4.create(),ve=i.mat4.create(),i.mat4.perspective(_e,45*Math.PI/180,innerWidth/innerHeight,.1,1e3),function(t,e){var n=new XMLHttpRequest;n.overrideMimeType("application/json"),n.open("GET",t,!0),n.onreadystatechange=function(){if(4===n.readyState&&"200"==n.status){var t=JSON.parse(n.responseText);e(t)}},n.send(null)}("./assets/models/dragon3k.json",function(t){pe=t,I(),function(){(he=x(ue,g,b)).aPosition=ue.getAttribLocation(he,"aPosition"),he.aColor=ue.getAttribLocation(he,"aColor"),he.uPerspective=ue.getUniformLocation(he,"uPerspective"),he.uModel=ue.getUniformLocation(he,"uModel"),he.uView=ue.getUniformLocation(he,"uView"),he.uTexture=ue.getUniformLocation(he,"uTexture"),he.uUseTexture=ue.getUniformLocation(he,"uUseTexture"),he.uRayCount=ue.getUniformLocation(he,"uRayCount"),he.uResolution=ue.getUniformLocation(he,"uResolution"),he.vertexBuffer=ue.createBuffer();var t=ue.createTexture();ue.bindTexture(ue.TEXTURE_2D,t),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MAG_FILTER,ue.LINEAR),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MIN_FILTER,ue.LINEAR),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_S,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_T,ue.CLAMP_TO_EDGE),ue.texImage2D(ue.TEXTURE_2D,0,ue.RGBA,500,500,0,ue.RGBA,ue.FLOAT,null),he.texture=t,ue.bindBuffer(ue.ARRAY_BUFFER,he.vertexBuffer),ue.bufferData(ue.ARRAY_BUFFER,new Float32Array(function(){var t=[];return t.push(-3,0,-3,1,1,0,0,1),t.push(-3,0,3,1,1,0,0,1),t.push(3,0,-3,1,1,0,0,1),t.push(-3,0,3,1,1,0,0,1),t.push(3,0,3,1,1,0,0,1),t.push(3,0,-3,1,1,0,0,1),be.push([{x:-3,y:0,z:-3},{x:-3,y:0,z:3},{x:3,y:0,z:-3}],[{x:-3,y:0,z:3},{x:3,y:0,z:3},{x:3,y:0,z:-3}]),Me.push(i.vec3.fromValues(0,1,0),i.vec3.fromValues(0,1,0)),he.vertexCount=t.length/8,t}()),ue.STATIC_DRAW)}(),(fe=x(ue,M,y)).aPosition=ue.getAttribLocation(fe,"aPosition"),fe.aNormal=ue.getAttribLocation(fe,"aNormal"),fe.uPerspective=ue.getUniformLocation(fe,"uPerspective"),fe.uModel=ue.getUniformLocation(fe,"uModel"),fe.uView=ue.getUniformLocation(fe,"uView"),fe.uTexture=ue.getUniformLocation(fe,"uTexture"),fe.uCubeTexture=ue.getUniformLocation(fe,"uCubeTexture"),fe.uUseTexture=ue.getUniformLocation(fe,"uUseTexture"),fe.uEyePosition=ue.getUniformLocation(fe,"uEyePosition"),fe.uRayCount=ue.getUniformLocation(fe,"uRayCount"),fe.uLightPosition=ue.getUniformLocation(fe,"uLightPosition"),fe.uLightDirection=ue.getUniformLocation(fe,"uLightDirection"),fe.uLightSize=ue.getUniformLocation(fe,"uLightSize"),fe.uLightPlaneU=ue.getUniformLocation(fe,"uLightPlaneU"),fe.uLightPlaneV=ue.getUniformLocation(fe,"uLightPlaneV"),fe.uUseSkybox=ue.getUniformLocation(fe,"uUseSkybox"),fe.uIOR=ue.getUniformLocation(fe,"uIOR"),fe.uDispersion=ue.getUniformLocation(fe,"uDispersion"),fe.uRefractiveLightReflection=ue.getUniformLocation(fe,"uRefractiveLightReflection"),fe.vertexBuffer=ue.createBuffer(),ue.bindBuffer(ue.ARRAY_BUFFER,fe.vertexBuffer),ue.bufferData(ue.ARRAY_BUFFER,new Float32Array(function(){for(var t=pe,e=t.meshes[0].vertices,n=(t.meshes[0].normals,t.meshes[0].faces),o=[],r=0;r<n.length;r++){for(var a=[],s=0;s<3;s++){var l=n[r][s];a.push({x:1.2*e[3*l+0],y:1.2*e[3*l+1],z:1.2*e[3*l+2]})}var u=i.vec3.fromValues(a[1].x-a[0].x,a[1].y-a[0].y,a[1].z-a[0].z),c=i.vec3.fromValues(a[2].x-a[0].x,a[2].y-a[0].y,a[2].z-a[0].z),d=i.vec3.fromValues(u[1]*c[2]-u[2]*c[1],u[2]*c[0]-u[0]*c[2],u[0]*c[1]-u[1]*c[0]);i.vec3.normalize(d,d);for(var s=0;s<3;s++){var l=n[r][s];o.push(1.2*e[3*l+0]),o.push(1.2*e[3*l+1]),o.push(1.2*e[3*l+2]),o.push(1),o.push(d[0]),o.push(d[1]),o.push(d[2]),o.push(1)}be.push(a),Me.push(d)}return fe.vertexCount=o.length/8,fe.raycastData=be,o}()),ue.STATIC_DRAW),(ye=x(ue,E,A)).aPosition=ue.getAttribLocation(ye,"aPosition"),ye.uPerspective=ue.getUniformLocation(ye,"uPerspective"),ye.uModel=ue.getUniformLocation(ye,"uModel"),ye.uView=ue.getUniformLocation(ye,"uView"),ye.vertexBuffer=ue.createBuffer(),ue.bindBuffer(ue.ARRAY_BUFFER,ye.vertexBuffer),ue.bufferData(ue.ARRAY_BUFFER,new Float32Array(se()),ue.STATIC_DRAW),function(){var t=Lt.addFolder("Performance"),e=Lt.addFolder("Light params"),n=Lt.addFolder("Light position");t.add(kt,"raysPerCycle").onFinishChange(()=>me.updateRaycount(kt)),t.add(kt,"resolution",10,1e3).onChange(()=>me.updateResolution(kt)),t.add(kt,"skybox"),e.add(kt,"dispersion",0,.1).onChange(()=>me.updateParams(kt)),e.add(kt,"IOR",1,1.95).onChange(()=>me.updateParams(kt)),e.add(kt,"lightStrenght",0,15).onChange(()=>me.updateParams(kt)),e.add(kt,"lightSize",0,5).onChange(()=>me.updateParams(kt)),e.add(kt,"refractiveLightReflection"),n.add(kt,"lightYaw",0,6.28).onChange(()=>me.updateParams(kt)),n.add(kt,"lightPitch",0,1.57).onChange(()=>me.updateParams(kt)),n.add(kt,"lightDistance",.5,8).onChange(()=>me.updateParams(kt)),t.open(),e.open(),n.open(),Lt.add(kt,"reset")}(),function(t,e){le(kt),Ot=t,Vt=e,Nt={x:0,y:0,z:0},Ht={x:0,y:0,z:0},Bt=new Float32Array(Gt*Gt*4),Ut=new F.a.BVH(Ot,oe);for(var n=0;n<Bt.length;n++)Bt[n]=0}(be,Me),requestAnimationFrame(we)}),window.addEventListener("wheel",function(t){t.deltaY<0?de.radius*=.95:de.radius+=.2});var ye,Se=0;function we(t){requestAnimationFrame(we);var e=(t*=.001)-Se;Se=t,ue.clearColor(0,0,0,1),ue.clear(ue.COLOR_BUFFER_BIT),ue.enable(ue.DEPTH_TEST),ve=de.getViewMatrix(e,.5),function(){for(var t=0;t<jt;t++)ie();$t+=jt,ue.bindTexture(ue.TEXTURE_2D,he.texture),ue.texImage2D(ue.TEXTURE_2D,0,ue.RGBA,Gt,Gt,0,ue.RGBA,ue.FLOAT,Bt)}(),kt.skybox&&(ue.disable(ue.DEPTH_TEST),ue.useProgram(D),ue.bindBuffer(ue.ARRAY_BUFFER,D.vertexBuffer),ue.enableVertexAttribArray(D.aPosition),ue.enableVertexAttribArray(D.aColor),ue.vertexAttribPointer(D.aPosition,4,ue.FLOAT,!1,0,0),ue.uniformMatrix4fv(D.uPerspective,!1,_e),ue.uniformMatrix4fv(D.uModel,!1,xe),ue.uniformMatrix4fv(D.uView,!1,ve),ue.activeTexture(ue.TEXTURE0),ue.bindTexture(ue.TEXTURE_CUBE_MAP,D.texture),ue.uniform1i(D.uTexture,0),ue.drawArrays(ue.TRIANGLES,0,36),ue.enable(ue.DEPTH_TEST)),ue.useProgram(he),ue.bindBuffer(ue.ARRAY_BUFFER,he.vertexBuffer),ue.enableVertexAttribArray(he.aPosition),ue.enableVertexAttribArray(he.aColor),ue.vertexAttribPointer(he.aPosition,4,ue.FLOAT,!1,8*ge,0),ue.vertexAttribPointer(he.aColor,4,ue.FLOAT,!1,8*ge,4*ge),ue.uniformMatrix4fv(he.uPerspective,!1,_e),ue.uniformMatrix4fv(he.uModel,!1,xe),ue.uniformMatrix4fv(he.uView,!1,ve),ue.uniform1i(he.uUseTexture,1),ue.uniform1f(he.uRayCount,$t),ue.uniform1f(he.uResolution,Gt),ue.activeTexture(ue.TEXTURE0),ue.bindTexture(ue.TEXTURE_2D,he.texture),ue.uniform1i(he.uTexture,0),ue.drawArrays(ue.TRIANGLES,0,he.vertexCount),ue.enable(ue.CULL_FACE),ue.cullFace(ue.BACK),ue.useProgram(ye),ue.bindBuffer(ue.ARRAY_BUFFER,ye.vertexBuffer),ue.enableVertexAttribArray(ye.aPosition),ue.vertexAttribPointer(ye.aPosition,4,ue.FLOAT,!1,0,0),ue.uniformMatrix4fv(ye.uPerspective,!1,_e),ue.uniformMatrix4fv(ye.uModel,!1,xe),ue.uniformMatrix4fv(ye.uView,!1,ve),ue.drawArrays(ue.TRIANGLES,0,6),ue.disable(ue.CULL_FACE),function(t,e){ue.useProgram(fe),ue.bindBuffer(ue.ARRAY_BUFFER,fe.vertexBuffer),ue.enableVertexAttribArray(fe.aPosition),ue.enableVertexAttribArray(fe.aNormal),ue.vertexAttribPointer(fe.aPosition,4,ue.FLOAT,!1,8*ge,0),ue.vertexAttribPointer(fe.aNormal,4,ue.FLOAT,!1,8*ge,4*ge),ve=de.getViewMatrix(e,.5),ue.uniformMatrix4fv(fe.uPerspective,!1,_e),ue.uniformMatrix4fv(fe.uModel,!1,xe),ue.uniformMatrix4fv(fe.uView,!1,ve),ue.uniform1i(fe.uUseTexture,0),ue.uniform1f(fe.uRefractiveLightReflection,kt.refractiveLightReflection?1:0),ue.uniform1f(fe.uIOR,qt),ue.uniform1f(fe.uDispersion,.025*kt.dispersion),ue.uniform1f(fe.uRayCount,$t),ue.uniform1f(fe.uUseSkybox,kt.skybox?1:0),ue.uniform3f(fe.uEyePosition,de.pos[0],de.pos[1],de.pos[2]),ue.uniform3f(fe.uLightPosition,Yt.x,Yt.y,Yt.z),ue.uniform3f(fe.uLightDirection,Xt.x,Xt.y,Xt.z),ue.uniform1f(fe.uLightSize,Wt),ue.uniform3f(fe.uLightPlaneU,te[0],te[1],te[2]),ue.uniform3f(fe.uLightPlaneV,ee[0],ee[1],ee[2]),ue.activeTexture(ue.TEXTURE0),ue.bindTexture(ue.TEXTURE_2D,he.texture),ue.uniform1i(fe.uTexture,0),ue.activeTexture(ue.TEXTURE1),ue.bindTexture(ue.TEXTURE_2D,D.texture),ue.uniform1i(fe.uCubeTexture,1),ue.drawArrays(ue.TRIANGLES,0,fe.vertexCount)}(0,e)}},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}}]);